<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="robots" content="noindex, nofollow">

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Cask Data, Inc." name="author" />
<meta content="HTTP RESTful Interface to the Cask Data Application Platform" name="description" />
<meta content="Copyright © 2014-2015 Cask Data, Inc." name="copyright" />
<script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-55081520-2']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>Metrics HTTP RESTful API &mdash; Cask Data Application Platform 2.8.3 Documentation</title>
    
    <link rel="stylesheet" href="../../_static/cdap.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    



    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.8.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Cask Data Application Platform 2.8.3 Documentation" href="../../index.html" />
    <link rel="up" title="CDAP HTTP RESTful API v3" href="index.html" />
    <link rel="next" title="Monitor HTTP RESTful API" href="monitor.html" />
    <link rel="prev" title="Logging HTTP RESTful API" href="logging.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="monitor.html" title="Monitor HTTP RESTful API"
             accesskey="N">Next</a> |</li>
        <li class="right" >
          <a href="logging.html" title="Logging HTTP RESTful API"
             accesskey="P">Previous</a> |</li>
        
        <script type="text/javascript" src="../../_static/version-menu.js"></script>
        <script src="http://docs.cask.co/cdap/json-versions.js"/></script>
        <script>window.setVersion('2.8.3');</script>
       
        <li><a href="../../table-of-contents.html">CDAP Reference Manual</a> &raquo;</li>
          <li><a href="../index.html" >CDAP HTTP RESTful API</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">CDAP HTTP RESTful API v3</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="metrics-http-restful-api">
<span id="http-restful-api-metrics"></span><h1>Metrics HTTP RESTful API<a class="headerlink" href="#metrics-http-restful-api" title="Permalink to this headline">¶</a></h1>
<p>As Applications process data, CDAP collects metrics about the Application’s behavior and
performance. Some of these metrics are the same for every Application—how many events are
processed, how many data operations are performed, etc.—and are thus called <strong>system</strong> or CDAP
metrics.</p>
<p>Other metrics are <strong>user-defined</strong> and differ from Application to Application.
For details on how to add metrics to your Application, see the section on
<a class="reference external" href="../../source/../../admin-manual/operations/metrics.html#operations-metrics" title="(in Cask Data Application Platform v2.8.3)"><span class="xref std std-ref">User-Defined Metrics</span></a> in
the <a class="reference external" href="../../source/../../admin-manual/index.html#admin-index" title="(in Cask Data Application Platform v2.8.3)"><span class="xref std std-ref">CDAP Administration Manual.</span></a></p>
<div class="section" id="metrics-data">
<h2>Metrics Data<a class="headerlink" href="#metrics-data" title="Permalink to this headline">¶</a></h2>
<p>Metrics data is identified as a combination of two entities:</p>
<ul class="simple">
<li>Metrics context</li>
<li>Metrics name</li>
</ul>
<p><strong>Metrics contexts</strong> are hierarchal, rooted in the CDAP instance, and extend through
namespaces, applications, and down to the individual elements.</p>
<p>For example: the metrics context
<code class="docutils literal"><span class="pre">namespace.default.app.PurchaseHistory.flow.PurchaseFlow</span></code> is a context that identifies a
Flow. It has a parent context, <code class="docutils literal"><span class="pre">namespace.default.app.PurchaseHistory</span></code>, which
identifies the parent application.</p>
<p>Each level of the context is described by a pair, composed of a tag name and a value, such as:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">flow.PurchaseFlow</span></code> (tag name: <em>flow</em>, value: <em>PurchaseFlow</em>)</li>
<li><code class="docutils literal"><span class="pre">app.PurchaseHistory</span></code> (tag name: <em>app</em>, value: <em>PurchaseHistory</em>)</li>
<li><code class="docutils literal"><span class="pre">namespace.default</span></code> (tag name: <em>namespace</em>, value: <em>default</em>)</li>
</ul>
<p><strong>Metrics names</strong> are either names generated by CDAP, and pre-pended with <code class="docutils literal"><span class="pre">system</span></code>, or
are names set by a developer when writing an application, which are pre-pended with <code class="docutils literal"><span class="pre">user</span></code>.</p>
<p>System metrics vary depending on the context; a list is available of <a class="reference internal" href="#available-system-metrics"><span>common system
metrics</span></a> for different contexts. User metrics are defined by
the application developer and thus are completely dependent on what the developer sets.</p>
<p>In either case, searches using this API will show, for a given context, all available metrics.</p>
<div class="section" id="available-contexts">
<h3>Available Contexts<a class="headerlink" href="#available-contexts" title="Permalink to this headline">¶</a></h3>
<p>The context of a metric is typically enclosed into a hierarchy of contexts. For example,
the Flowlet context is enclosed in the Flow context, which in turn is enclosed in the
Application context. A metric can always be queried (and aggregated) relative to any
enclosing context. These are the available Application contexts of CDAP:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">System Metric</th>
<th class="head">Context</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>One Flowlet of a Flow</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.app.&lt;app-id&gt;.flow.&lt;flow-id&gt;.flowlet.&lt;flowlet-id&gt;</span></code></td>
</tr>
<tr class="row-odd"><td>All Flowlets of a Flow</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.app.&lt;app-id&gt;.flow.&lt;flow-id&gt;</span></code></td>
</tr>
<tr class="row-even"><td>All Flowlets of all app of an Application</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.app.&lt;app-id&gt;.flow.*</span></code></td>
</tr>
<tr class="row-odd"><td>One Worker</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.app.&lt;app-id&gt;.worker.&lt;worker-id&gt;</span></code></td>
</tr>
<tr class="row-even"><td>All Workers of an Application</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.app.&lt;app-id&gt;.workers.*</span></code></td>
</tr>
<tr class="row-odd"><td>All Mappers of a MapReduce</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.app.&lt;app-id&gt;.mapreduce.&lt;mapreduce-id&gt;.tasktype.m</span></code></td>
</tr>
<tr class="row-even"><td>All Reducers of a MapReduce</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.app.&lt;app-id&gt;.mapreduce.&lt;mapreduce-id&gt;.tasktype.r</span></code></td>
</tr>
<tr class="row-odd"><td>One MapReduce</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.app.&lt;app-id&gt;.mapreduce.&lt;mapreduce-id&gt;</span></code></td>
</tr>
<tr class="row-even"><td>All MapReduce of an Application</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.app.&lt;app-id&gt;.mapreduce.*</span></code></td>
</tr>
<tr class="row-odd"><td>One Spark Program</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.app.&lt;app-id&gt;.spark.&lt;spark-id&gt;</span></code></td>
</tr>
<tr class="row-even"><td>One Service</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.app.&lt;app-id&gt;.service.&lt;service-id&gt;</span></code></td>
</tr>
<tr class="row-odd"><td>All Services of an Application</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.app.&lt;app-id&gt;.service.*</span></code></td>
</tr>
<tr class="row-even"><td>All components of an Application</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.app.&lt;app-id&gt;</span></code></td>
</tr>
<tr class="row-odd"><td>All components of all Applications</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;</span></code></td>
</tr>
</tbody>
</table>
<p>Stream metrics are only available at the Stream level and the only available context is:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Stream Metric</th>
<th class="head">Context</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>A single Stream</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.stream.&lt;stream-id&gt;</span></code></td>
</tr>
</tbody>
</table>
<p>Dataset metrics are available at the Dataset level, but they can also be queried down to the
Flowlet, Worker, Service, Mapper, or Reducer level:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Dataset Metric</th>
<th class="head">Context</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>A single Dataset in the context of a single Flowlet</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.dataset.&lt;dataset-id&gt;.app.&lt;app-id&gt;.flow.&lt;flow-id&gt;.flowlet.&lt;flowlet-id&gt;</span></code></td>
</tr>
<tr class="row-odd"><td>A single Dataset in the context of a single Flow</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.dataset.&lt;dataset-id&gt;.app.&lt;app-id&gt;.flow.&lt;flow-id&gt;</span></code></td>
</tr>
<tr class="row-even"><td>A single Dataset in the context of a specific Application</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.dataset.&lt;dataset-id&gt;.app.&lt;app-id&gt;</span></code></td>
</tr>
<tr class="row-odd"><td>A single Dataset across all Applications</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.dataset.&lt;dataset-id&gt;</span></code></td>
</tr>
<tr class="row-even"><td>All Datasets across all Applications</td>
<td><code class="docutils literal"><span class="pre">namespace.&lt;namespace&gt;.dataset.*</span></code></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="available-system-metrics">
<span id="id1"></span><h3>Available System Metrics<a class="headerlink" href="#available-system-metrics" title="Permalink to this headline">¶</a></h3>
<p>Note that a user metric may have the same name as a system metric; they are distinguished
by prepending the respective prefix when querying: <code class="docutils literal"><span class="pre">user</span></code> or <code class="docutils literal"><span class="pre">system</span></code>.</p>
<p>These metrics are available in a Datasets context:</p>
<table border="1" class="docutils">
<colgroup>
<col width="60%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Datasets Metric</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">system.store.bytes</span></code></td>
<td>Number of bytes written</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">system.store.ops</span></code></td>
<td>Operations (reads and writes) performed</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">system.store.reads</span></code></td>
<td>Read operations performed</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">system.store.writes</span></code></td>
<td>Write operations performed</td>
</tr>
</tbody>
</table>
<p>These metrics are available in a Flowlet context:</p>
<table border="1" class="docutils">
<colgroup>
<col width="60%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Flowlet Metric</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">system.process.errors</span></code></td>
<td>Number of errors while processing</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">system.process.events.processed</span></code></td>
<td>Number of events/data objects processed</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">system.process.events.in</span></code></td>
<td>Number of events read in by the Flowlet</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">system.process.events.out</span></code></td>
<td>Number of events emitted by the Flowlet</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">system.process.tuples.read</span></code></td>
<td>Number of tuples read by the Flowlet</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">system.store.bytes</span></code></td>
<td>Number of bytes written to Datasets</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">system.store.ops</span></code></td>
<td>Operations (writes and read) performed on Datasets</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">system.store.reads</span></code></td>
<td>Read operations performed on Datasets</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">system.store.writes</span></code></td>
<td>Write operations performed on Datasets</td>
</tr>
</tbody>
</table>
<p>These metrics are available in a Mappers and Reducers context:</p>
<table border="1" class="docutils">
<colgroup>
<col width="60%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Mappers and Reducers Metric</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">system.process.completion</span></code></td>
<td>A number from 0 to 100 indicating the progress of the Map or Reduce phase</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">system.process.entries.in</span></code></td>
<td>Number of entries read in by the Map or Reduce phase</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">system.process.entries.out</span></code></td>
<td>Number of entries written out by the Map or Reduce phase</td>
</tr>
</tbody>
</table>
<p>These metrics are available in a Services context:</p>
<table border="1" class="docutils">
<colgroup>
<col width="60%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Services Metric</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">system.requests.count</span></code></td>
<td>Number of requests made to the Service</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">system.response.successful.count</span></code></td>
<td>Number of successful requests completed by the Service</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">system.response.server.error.count</span></code></td>
<td>Number of failures seen by the Service</td>
</tr>
</tbody>
</table>
<p>These metrics are available in a Spark context, where <code class="docutils literal"><span class="pre">&lt;spark-id&gt;</span></code>
depends on the Spark program being queried:</p>
<table border="1" class="docutils">
<colgroup>
<col width="60%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Spark Metric</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">system.&lt;spark-id&gt;.BlockManager.disk.diskSpaceUsed_MB</span></code></td>
<td>Disk space used by the Block Manager</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">system.&lt;spark-id&gt;.BlockManager.memory.maxMem_MB</span></code></td>
<td>Maximum memory given to the Block Manager</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">system.&lt;spark-id&gt;.BlockManager.memory.memUsed_MB</span></code></td>
<td>Memory used by the Block Manager</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">system.&lt;spark-id&gt;.BlockManager.memory.remainingMem_MB</span></code></td>
<td>Memory remaining to the Block Manager</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">system.&lt;spark-id&gt;.DAGScheduler.job.activeJobs</span></code></td>
<td>Number of active jobs</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">system.&lt;spark-id&gt;.DAGScheduler.job.allJobs</span></code></td>
<td>Total number of jobs</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">system.&lt;spark-id&gt;.DAGScheduler.stage.failedStages</span></code></td>
<td>Number of failed stages</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">system.&lt;spark-id&gt;.DAGScheduler.stage.runningStages</span></code></td>
<td>Number of running stages</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">system.&lt;spark-id&gt;.DAGScheduler.stage.waitingStages</span></code></td>
<td>Number of waiting stages</td>
</tr>
</tbody>
</table>
<p>These metrics are available in a Streams context:</p>
<table border="1" class="docutils">
<colgroup>
<col width="60%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Streams Metric</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">system.collect.events</span></code></td>
<td>Number of events collected by the Stream</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">system.collect.bytes</span></code></td>
<td>Number of bytes collected by the Stream</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="searches-and-queries">
<h2>Searches and Queries<a class="headerlink" href="#searches-and-queries" title="Permalink to this headline">¶</a></h2>
<p>The process of retrieving a metric involves these steps:</p>
<ol class="arabic simple">
<li>Obtain (usually through a search) the correct context for a metric;</li>
<li>Obtain (usually through a search within the context) the available metrics;</li>
<li>Querying for a specific metric, supplying the context and any parameters.</li>
</ol>
</div>
<div class="section" id="search-for-contexts">
<h2>Search for Contexts<a class="headerlink" href="#search-for-contexts" title="Permalink to this headline">¶</a></h2>
<p>To search for the available contexts, perform an HTTP request:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">POST &#39;&lt;base-url&gt;/metrics/search?target=childContext[&amp;context=&lt;context&gt;]&#39;</span>
</pre></div>
</div>
<p>The optional <code class="docutils literal"><span class="pre">&lt;context&gt;</span></code> defines a metrics context to search within. If it is not
provided, the search is performed across all data. The available contexts that are returned
can be used to query for a lower-level of contexts.</p>
<p>You can also define the query to search in a given context across all values of one or
more tags provided in the context by specifying <code class="docutils literal"><span class="pre">*</span></code> as a value for a tag. See the
examples below for its use.</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&lt;context&gt;</span></code> <em>[Optional]</em></td>
<td>Metrics context to search within. If not provided, the search is provided across
all contexts.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><th class="stub">HTTP Method</th>
<td><code class="docutils literal"><span class="pre">POST</span> <span class="pre">'&lt;base-url&gt;/metrics/search?target=childContext'</span></code></td>
</tr>
<tr class="row-even"><th class="stub">Returns</th>
<td><code class="docutils literal"><span class="pre">[&quot;namespace.default&quot;,</span> <span class="pre">&quot;namespace.system&quot;]</span></code></td>
</tr>
<tr class="row-odd"><th class="stub">Description</th>
<td>Returns all first-level contexts; in this case, two namespaces.</td>
</tr>
<tr class="row-even"><th class="stub">&nbsp;</th>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><th class="stub">HTTP Method</th>
<td><code class="docutils literal"><span class="pre">POST</span> <span class="pre">'&lt;base-url&gt;/metrics/search?target=childContext&amp;context=namespace.default'</span></code></td>
</tr>
<tr class="row-even"><th class="stub">Returns</th>
<td><code class="docutils literal"><span class="pre">[&quot;namespace.default.app.HelloWorld&quot;,</span> <span class="pre">&quot;namespace.default.app.PurchaseHistory&quot;,</span> <span class="pre">&quot;namespace.default.dataset.purchases&quot;,</span>
<span class="pre">&quot;namespace.default.dataset.whom&quot;,</span> <span class="pre">&quot;namespace.default.stream.purchaseStream&quot;,</span> <span class="pre">...,</span> <span class="pre">&quot;namespace.default.stream.who&quot;]</span></code></td>
</tr>
<tr class="row-odd"><th class="stub">Description</th>
<td>Returns all child contexts of the given parent context; in this case, all entities in the default namespace.</td>
</tr>
<tr class="row-even"><th class="stub">&nbsp;</th>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><th class="stub">HTTP Method</th>
<td><code class="docutils literal"><span class="pre">POST</span> <span class="pre">'&lt;base-url&gt;/metrics/search?target=childContext&amp;context=</span></code>
<code class="docutils literal"><span class="pre">namespace.default.app.PurchaseHistory.flow.PurchaseFlow.run.*'</span></code></td>
</tr>
<tr class="row-even"><th class="stub">Returns</th>
<td><code class="docutils literal"><span class="pre">[&quot;namespace.default.app.PurchaseHistory.flow.PurchaseFlow.run.*.flowlet.collector&quot;,</span>
<span class="pre">&quot;namespace.default.app.PurchaseHistory.flow.PurchaseFlow.run.*.flowlet.reader&quot;]</span></code></td>
</tr>
<tr class="row-odd"><th class="stub">Description</th>
<td>Queries all available contexts within the <em>PurchaseHistory</em>&#8216;s <em>PurchaseFlow</em> for any run;
in this case, it returns all available Flowlets.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="search-for-metrics">
<h2>Search for Metrics<a class="headerlink" href="#search-for-metrics" title="Permalink to this headline">¶</a></h2>
<p>To search for the available metrics within a given context, perform an HTTP POST request:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">POST &#39;&lt;base-url&gt;/metrics/search?target=metric&amp;context=&lt;context&gt;&#39;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&lt;context&gt;</span></code></td>
<td>Metrics context to search within.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><th class="stub">HTTP Method</th>
<td><code class="docutils literal"><span class="pre">POST</span> <span class="pre">'&lt;base-url&gt;/metrics/search?target=metric&amp;</span></code>
<code class="docutils literal"><span class="pre">context=namespace.default.app.PurchaseHistory'</span></code></td>
</tr>
<tr class="row-even"><th class="stub">Returns</th>
<td><code class="docutils literal"><span class="pre">[&quot;system.dataset.store.bytes&quot;,&quot;system.dataset.store.ops&quot;,&quot;system.dataset.store.reads&quot;,</span></code>
<code class="docutils literal"><span class="pre">&quot;system.dataset.store.writes&quot;,&quot;system.process.bytes&quot;,...,&quot;user.customers.count&quot;]</span></code></td>
</tr>
<tr class="row-odd"><th class="stub">Description</th>
<td>Returns all metrics in the context of the application <em>PurchaseHistory</em> of the
<em>default</em> namespace; in this case, returns a list of system and user-defined metrics.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="querying-a-metric">
<h2>Querying A Metric<a class="headerlink" href="#querying-a-metric" title="Permalink to this headline">¶</a></h2>
<p>Once you know the context and the metric to query, you can formulate a request for the
metrics data.</p>
<p>To query a metric within a given context, perform an HTTP POST request:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">POST &#39;&lt;base-url&gt;/metrics/query?context=&lt;context&gt;[&amp;groupBy=&lt;tags&gt;]&amp;metric=&lt;metric&gt;&amp;&lt;time-range&gt;&#39;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&lt;context&gt;</span></code></td>
<td>Metrics context to search within</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&lt;tags&gt;</span></code> (Optional)</td>
<td>Comma-separated <a class="reference internal" href="#http-restful-api-metrics-groupby"><span>tag list</span></a> by which to group
results (optional)</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&lt;metric&gt;</span></code></td>
<td>Metric being queried</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&lt;time-range&gt;</span></code></td>
<td>A <a class="reference internal" href="#http-restful-api-metrics-time-range"><span>time range</span></a> or <code class="docutils literal"><span class="pre">aggregate=true</span></code> for
all since the Application was deployed</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><th class="stub">HTTP Method</th>
<td><code class="docutils literal"><span class="pre">POST</span> <span class="pre">'&lt;base-url&gt;/metrics/query?context=namespace.default.app.HelloWorld.flow.</span></code>
<code class="docutils literal"><span class="pre">WhoFlow.flowlet.saver&amp;metric=system.process.events.processed&amp;aggregate=true'</span></code></td>
</tr>
<tr class="row-even"><th class="stub">Description</th>
<td>Using a <em>System</em> metric, <em>system.process.events.processed</em></td>
</tr>
<tr class="row-odd"><th class="stub">&nbsp;</th>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><th class="stub">HTTP Method</th>
<td><code class="docutils literal"><span class="pre">POST</span> <span class="pre">'&lt;base-url&gt;/metrics/query?context=namespace.default.app.HelloWorld.flow.</span></code>
<code class="docutils literal"><span class="pre">WhoFlow.run.13ac3a50-a435-49c8-a752-83b3c1e1b9a8.flowlet.saver&amp;metric=user.names.bytes&amp;aggregate=true'</span></code></td>
</tr>
<tr class="row-odd"><th class="stub">Description</th>
<td>Querying the <em>User-defined</em> metric <em>names.bytes</em>, of the Flow <em>saver</em>, by its run-ID</td>
</tr>
<tr class="row-even"><th class="stub">&nbsp;</th>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><th class="stub">HTTP Method</th>
<td><code class="docutils literal"><span class="pre">POST</span> <span class="pre">'&lt;base-url&gt;/metrics/query?context=namespace.default.app.HelloWorld.services</span></code>
<code class="docutils literal"><span class="pre">WhoService.runnables.WhoRun&amp;metric=user.names.bytes'</span></code></td>
</tr>
<tr class="row-even"><th class="stub">Description</th>
<td>Using a <em>User-defined</em> metric, <em>names.bytes</em> in a Service&#8217;s Handler</td>
</tr>
</tbody>
</table>
<div class="section" id="query-tips">
<h3>Query Tips<a class="headerlink" href="#query-tips" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">To retrieve the number of input data objects (“events”) processed by the Flowlet named <em>splitter</em>,
in the Flow <em>CountRandom</em> of the example application <em>CountRandom</em>, over the last 5 seconds, you can issue an HTTP
POST method:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">POST &#39;&lt;base-url&gt;/metrics/query?context=namespace.default.app.CountRandom.flow.CountRandom.</span>
<span class="go">  flowlet.splitter&amp;metric=system.process.events.processed&amp;start=now-5s&amp;count=5&#39;</span>
</pre></div>
</div>
<p>This returns a JSON response that has one entry for every second in the requested time interval. It will have
values only for the times where the metric was actually emitted (shown here &#8220;pretty-printed&#8221;):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">{</span>
<span class="go">  &quot;startTime&quot;: 1427225350,</span>
<span class="go">  &quot;endTime&quot;: 1427225354,</span>
<span class="go">  &quot;series&quot;: [</span>
<span class="go">    {</span>
<span class="go">      &quot;metricName&quot;: &quot;system.process.events.processed&quot;,</span>
<span class="go">      &quot;grouping&quot;: {</span>

<span class="go">      },</span>
<span class="go">      &quot;data&quot;: [</span>
<span class="go">        {</span>
<span class="go">          &quot;time&quot;: 1427225350,</span>
<span class="go">          &quot;value&quot;: 760</span>
<span class="go">        },</span>
<span class="go">        {</span>
<span class="go">          &quot;time&quot;: 1427225351,</span>
<span class="go">          &quot;value&quot;: 774</span>
<span class="go">        },</span>
<span class="go">        {</span>
<span class="go">          &quot;time&quot;: 1427225352,</span>
<span class="go">          &quot;value&quot;: 792</span>
<span class="go">        },</span>
<span class="go">        {</span>
<span class="go">          &quot;time&quot;: 1427225353,</span>
<span class="go">          &quot;value&quot;: 756</span>
<span class="go">        },</span>
<span class="go">        {</span>
<span class="go">          &quot;time&quot;: 1427225354,</span>
<span class="go">          &quot;value&quot;: 766</span>
<span class="go">        }</span>
<span class="go">      ]</span>
<span class="go">    }</span>
<span class="go">  ]</span>
<span class="go">}</span>
</pre></div>
</div>
</li>
<li><p class="first">You can retrieve <a class="reference internal" href="#http-restful-api-metrics-querying-by-run-id"><span>results based on a run-id</span></a>.</p>
</li>
<li><p class="first">If a run-ID is not specified, we aggregate the events processed for all the runs of this flow.</p>
<p>The resulting timeseries will represent aggregated values for the context specified.
Currently, summation is used as the aggregation function. So, if you query for the
<code class="docutils literal"><span class="pre">system.process.events.processed</span></code> metric for a Flow—thus across all Flowlets—since this metric was actually emitted at the Flowlet level, the resulting values
retrieved will be a sum across all Flowlets of the Flow.</p>
</li>
<li><p class="first">If you want the number of input objects processed across all Flowlets of a Flow, you address the metrics
API at the Flow context:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">POST &#39;&lt;base-url&gt;/metrics/query?context=namespace.default.app.CountRandom.flow.CountRandom.flowlet.*</span>
<span class="go">  &amp;metric=system.process.events.processed&amp;start=now-5s&amp;count=5&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first">Similarly, you can address the context of all Flows of an Application, an entire Application, or the entire
namespace of a CDAP instance:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">POST &#39;&lt;base-url&gt;/metrics/query?context=namespace.default.app.CountRandom.flow.*</span>
<span class="go">  &amp;metric=system.process.events.processed&amp;start=now-5s&amp;count=5&#39;</span>

<span class="go">POST &#39;&lt;base-url&gt;/metrics/query?context=namespace.default.app.CountRandom</span>
<span class="go">  &amp;metric=system.process.events.processed&amp;start=now-5s&amp;count=5&#39;</span>

<span class="go">POST &#39;&lt;base-url&gt;/metrics/query?context=namespace.default</span>
<span class="go">  &amp;metric=system.process.events.processed&amp;start=now-5s&amp;count=5&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first">To request user-defined metrics instead of system metrics, specify <code class="docutils literal"><span class="pre">user</span></code> instead of <code class="docutils literal"><span class="pre">cdap</span></code> in the URL
and specify the user-defined metric at the end of the request.</p>
<p>For example, to request a user-defined metric for the <em>HelloWorld</em> Application&#8217;s <em>WhoFlow</em> Flow:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">POST &#39;&lt;base-url&gt;/metrics/query?context=namespace.default.app.HelloWorld.flow.WhoFlow.flowlet.saver</span>
<span class="go">  &amp;metric=user.names.bytes&amp;aggregate=true&#39;</span>
</pre></div>
</div>
</li>
</ul>
<ul class="simple" id="http-restful-api-metrics-multiple">
<span id="http-restful-api-v3-metrics-multiple"></span><li>Retrieving multiple metrics at once, by issuing an HTTP POST request with a JSON list as
the request body that enumerates the name and attributes for each metric, is currently not
supported in this API. Instead, use the <a class="reference internal" href="../http-restful-api-v2/metrics.html#http-restful-api-v2-metrics-multiple"><span>v2 API</span></a> until it is supported in a future release.</li>
</ul>
</div>
<div class="section" id="querying-for-multiple-time-series">
<span id="http-restful-api-metrics-groupby"></span><h3>Querying for Multiple Time-series<a class="headerlink" href="#querying-for-multiple-time-series" title="Permalink to this headline">¶</a></h3>
<p>In a query, the optional <code class="docutils literal"><span class="pre">groupBy</span></code> parameter defines a list of tags whose values are
used to build multiple timeseries. All data points that have the same values in tags
specified in the <code class="docutils literal"><span class="pre">groupBy</span></code> parameter will form a single timeseries. You can define
multiple tags for grouping by providing a comma-separated list.</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Tag List</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">groupBy=app</span></code></td>
<td>Retrieves the time series for each application.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">groupBy=app,flow</span></code></td>
<td>Retrieves a time series for each app and flow combination</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>The method:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">POST &#39;&lt;base-url&gt;/metrics/query?context=namespace.default.app.PurchaseHistory&amp;</span>
<span class="go">  groupBy=flow&amp;metric=user.customers.count&amp;start=now-2s&amp;end=now&#39;</span>
</pre></div>
</div>
<p>returns the <em>user.customers.count</em> metric in the context of the application
<em>PurchaseHistory</em> of the <em>default</em> namespace, for the specified time range, and grouped by
<code class="docutils literal"><span class="pre">flow</span></code> (results reformatted to fit):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">{</span>
<span class="go">  &quot;startTime&quot;: 1421188775,</span>
<span class="go">  &quot;endTime&quot;: 1421188777,</span>
<span class="go">  &quot;series&quot;: [</span>
<span class="go">    {</span>
<span class="go">      &quot;metricName&quot;: &quot;user.customers.count&quot;,</span>
<span class="go">      &quot;grouping&quot;: { &quot;flow&quot;: &quot;PurchaseHistoryFlow&quot; },</span>
<span class="go">      &quot;data&quot;: [</span>
<span class="go">        { &quot;time&quot;: 1421188776, &quot;value&quot;: 3 },</span>
<span class="go">        { &quot;time&quot;: 1421188777, &quot;value&quot;: 2 }</span>
<span class="go">      ]</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">      &quot;metricName&quot;: &quot;user.customers.count&quot;,</span>
<span class="go">      &quot;grouping&quot;: { &quot;flow&quot;: &quot;PurchaseAnalysisFlow&quot; },</span>
<span class="go">      &quot;data&quot;: [</span>
<span class="go">        { &quot;time&quot;: 1421188775, &quot;value&quot;: 1 },</span>
<span class="go">        { &quot;time&quot;: 1421188777, &quot;value&quot;: 2 }</span>
<span class="go">      ]</span>
<span class="go">    }</span>
<span class="go">  ]</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<div class="section" id="querying-by-a-time-range">
<span id="http-restful-api-metrics-time-range"></span><h3>Querying by a Time Range<a class="headerlink" href="#querying-by-a-time-range" title="Permalink to this headline">¶</a></h3>
<p>The time range of a metric query can be specified in various ways: either
<code class="docutils literal"><span class="pre">aggregate=true</span></code> to retrieve the total aggregated since the Application was deployed
or—in the case of Dataset metrics—since a Dataset was created;
or as a <code class="docutils literal"><span class="pre">start</span></code> and <code class="docutils literal"><span class="pre">end</span></code> to define a specific range and return a series of data points.</p>
<p>By default, queries without a time range retrieve a value based on <code class="docutils literal"><span class="pre">aggregate=true</span></code>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">aggregate=true</span></code></td>
<td>Total aggregated value for the metric since the Application was deployed.
If the metric is a gauge type, the aggregate will return the latest value set for
the metric.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">start=&lt;time&gt;&amp;end=&lt;time&gt;</span></code></td>
<td>Time range defined by start and end times, where the times are either in seconds
since the start of the Epoch, or a relative time, using <code class="docutils literal"><span class="pre">now</span></code> and times added to it.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">count=&lt;count&gt;</span></code></td>
<td>Number of time intervals since start with length of time interval defined by <em>resolution</em>.
If <code class="docutils literal"><span class="pre">count=60</span></code> and <code class="docutils literal"><span class="pre">resolution=1s</span></code>, the time range would be 60 seconds in length.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">resolution=[1s|1m|1h|auto]</span></code></td>
<td>Time resolution in seconds, minutes or hours; or if &#8220;auto&#8221;, one of <code class="docutils literal"><span class="pre">{1s,</span> <span class="pre">1m,</span> <span class="pre">1h}</span></code>
is used based on the time difference.</td>
</tr>
</tbody>
</table>
<p>With a specific time range, a <code class="docutils literal"><span class="pre">resolution</span></code> can be included to retrieve a series of data
points for a metric. By default, 1 second resolution is used. Acceptable values are noted
above. If <code class="docutils literal"><span class="pre">resolution=auto</span></code>, the resolution will be determined based on a time
difference calculated between the start and end times:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">(endTime</span> <span class="pre">-</span> <span class="pre">startTime)</span> <span class="pre">&gt;=</span> <span class="pre">3610</span> <span class="pre">seconds</span></code>, resolution will be 1 hour;</li>
<li><code class="docutils literal"><span class="pre">(endTime</span> <span class="pre">-</span> <span class="pre">startTime)</span> <span class="pre">&gt;=</span> <span class="pre">610</span> <span class="pre">seconds</span></code>, resolution will be 1 minute;</li>
<li>otherwise, resolution will be 1 second.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Time Range</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">start=now-30s&amp;end=now</span></code></td>
<td>The last 30 seconds. The start time is given in seconds relative to the current time.
You can apply simple math, using <code class="docutils literal"><span class="pre">now</span></code> for the current time,
<code class="docutils literal"><span class="pre">s</span></code> for seconds, <code class="docutils literal"><span class="pre">m</span></code> for minutes, <code class="docutils literal"><span class="pre">h</span></code> for hours and <code class="docutils literal"><span class="pre">d</span></code> for days.
For example: <code class="docutils literal"><span class="pre">now-5d-12h</span></code> is 5 days and 12 hours ago.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">start=1385625600&amp;</span></code> <code class="docutils literal"><span class="pre">end=1385629200</span></code></td>
<td>From <code class="docutils literal"><span class="pre">Thu,</span> <span class="pre">28</span> <span class="pre">Nov</span> <span class="pre">2013</span> <span class="pre">08:00:00</span> <span class="pre">GMT</span></code> to <code class="docutils literal"><span class="pre">Thu,</span> <span class="pre">28</span> <span class="pre">Nov</span> <span class="pre">2013</span> <span class="pre">09:00:00</span> <span class="pre">GMT</span></code>,
both given as since the start of the Epoch.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">start=1385625600&amp;</span></code> <code class="docutils literal"><span class="pre">count=3600&amp;</span></code> <code class="docutils literal"><span class="pre">resolution=1s</span></code></td>
<td>The same as before, the count given as a number of time intervals, each 1 second.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">start=1385625600&amp;</span></code> <code class="docutils literal"><span class="pre">end=1385629200&amp;</span></code> <code class="docutils literal"><span class="pre">resolution=1m</span></code></td>
<td>From <code class="docutils literal"><span class="pre">Thu,</span> <span class="pre">28</span> <span class="pre">Nov</span> <span class="pre">2013</span> <span class="pre">08:00:00</span> <span class="pre">GMT</span></code> to <code class="docutils literal"><span class="pre">Thu,</span> <span class="pre">28</span> <span class="pre">Nov</span> <span class="pre">2013</span> <span class="pre">09:00:00</span> <span class="pre">GMT</span></code>,
with 1 minute resolution, will return 61 data points with metrics aggregated for each minute.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">start=1385625600&amp;</span></code> <code class="docutils literal"><span class="pre">end=1385632800&amp;</span></code> <code class="docutils literal"><span class="pre">resolution=1h</span></code></td>
<td>From <code class="docutils literal"><span class="pre">Thu,</span> <span class="pre">28</span> <span class="pre">Nov</span> <span class="pre">2013</span> <span class="pre">08:00:00</span> <span class="pre">GMT</span></code> to <code class="docutils literal"><span class="pre">Thu,</span> <span class="pre">28</span> <span class="pre">Nov</span> <span class="pre">2013</span> <span class="pre">10:00:00</span> <span class="pre">GMT</span></code>,
with 1 hour resolution, will return 3 data points with metrics aggregated for each hour.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">POST &#39;&lt;base-url&gt;/metrics/query?context=namespace.default.app.CountRandom&amp;</span>
<span class="go">  metric=system.process.events.processed&amp;start=now-1h&amp;end=now&amp;resolution=1m&#39;</span>
</pre></div>
</div>
<p>This will return the value of the metric <em>system.process.events.processed</em> for the last
hour at one-second intervals.</p>
<p>For aggregates, you cannot specify a time range. As an example, to return the total number
of input objects processed since the Application <em>CountRandom</em> was deployed, assuming that
CDAP has not been stopped or restarted:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">POST &#39;&lt;base-url&gt;/metrics/query?context=namespace.default.app.CountRandom</span>
<span class="go">  &amp;metric=system.process.events.processed&amp;aggregate=true&#39;</span>
</pre></div>
</div>
<p>If a metric is a gauge type, the aggregate will return the latest value set for the metric.
For example, this request will retrieve the completion percentage for the map-stage of the MapReduce
<code class="docutils literal"><span class="pre">PurchaseHistoryWorkflow_PurchaseHistoryBuilder</span></code> (reformatted to fit):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">POST &#39;&lt;base-url&gt;/metrics/query?context=namespace.default.app.PurchaseHistory.mapreduce.</span>
<span class="go">    PurchaseHistoryWorkflow_PurchaseHistoryBuilder&amp;metric=system.process.completion&amp;aggregate=true&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="querying-by-run-id">
<span id="http-restful-api-metrics-querying-by-run-id"></span><h3>Querying by Run-ID<a class="headerlink" href="#querying-by-run-id" title="Permalink to this headline">¶</a></h3>
<p>Each execution of an program (Flow, MapReduce, Spark, Services, Worker) has an <a class="reference internal" href="lifecycle.html#rest-program-runs"><span>associated
run-ID</span></a> that uniquely identifies that program&#8217;s run. We can query
metrics for a program by its run-ID to retrieve the metrics for a particular run. Please see
the <a class="reference internal" href="lifecycle.html#rest-program-runs"><span>Run Records and Schedule</span></a> on retrieving active and historical
program runs.</p>
<p>When querying by <code class="docutils literal"><span class="pre">run-ID</span></code>, it is specified in the context after the <code class="docutils literal"><span class="pre">program-id</span></code> with the tag <code class="docutils literal"><span class="pre">run</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">...app.&lt;app-id&gt;.&lt;program-type&gt;.&lt;program-id&gt;.run.&lt;run-id&gt;</span>
</pre></div>
</div>
<p>Examples of using a run-ID (reformatted to fit):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">POST &#39;&lt;base-url&gt;/metrics/query?context=namespace.default.app.PurchaseHistory.flow.</span>
<span class="go">    MyFlow.run.364-789-1636765&amp;metric=system.process.completion&#39;</span>

<span class="go">POST &#39;&lt;base-url&gt;/metrics/query?context=namespace.default.app.PurchaseHistory.mapreduce.</span>
<span class="go">    PurchaseHistoryBuilder.run.453-454-447683&amp;metric=system.process.completion&#39;</span>

<span class="go">POST &#39;&lt;base-url&gt;/metrics/query?context=namespace.default.app.CountRandom.flow.CountRandom.run.</span>
<span class="go">  bca50436-9650-448e-9ab1-f1d186eb2285.flowlet.splitter&amp;metric=system.process.events.processed&amp;aggregate=true&#39;</span>
</pre></div>
</div>
<p>The last example will return something similar to (where <code class="docutils literal"><span class="pre">&quot;time&quot;=0</span></code> means aggregated total number):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">{&quot;startTime&quot;:0,&quot;endTime&quot;:0,&quot;series&quot;:[{&quot;metricName&quot;:&quot;system.process.events.processed&quot;,</span>
<span class="go"> &quot;grouping&quot;:{},&quot;data&quot;:[{&quot;time&quot;:0,&quot;value&quot;:11188}]}]}</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="manuals links">
    <h3><a href="../../table-of-contents/../../index.html"
        rel="nofollow">CDAP Documentation v2.8.3</a></h3>
    <ul class="this-page-menu">
      <li><div class=""></div><a href="../../table-of-contents/../../index.html"
            rel="nofollow">Introduction</a></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../developers-manual/index.html"
            rel="nofollow">Developers’ Manual</a></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../admin-manual/index.html"
            rel="nofollow">Administration Manual</a></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../integrations/index.html"
            rel="nofollow">Integrations</a></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../examples-manual/index.html"
            rel="nofollow">Examples, Guides, and Tutorials</a></li>
            
      <li><div class=""></div><b><a href="../../table-of-contents/../../reference-manual/index.html"
            rel="nofollow">Reference Manual</a></b></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../reference-manual/release-notes.html"
            rel="nofollow">Release Notes</a></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../reference-manual/glossary.html"
            rel="nofollow">Glossary</a></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../reference-manual/faq.html"
            rel="nofollow">FAQ</a></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../search.html"
            rel="nofollow">Search</a></li>
    </ul>
   </div><!--
  Copyright © 2014-2015 Cask Data, Inc.

  Licensed under the Apache License, Version 2.0 (the "License"); you may not
  use this file except in compliance with the License. You may obtain a copy of
  the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
  License for the specific language governing permissions and limitations under
  the License.
-->


    
<h3 class="pagenavtitle"><a href="../../table-of-contents.html">Reference Manual: Table&nbsp;of&nbsp;Contents</a></h3>
<nav class="pagenav">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html"> Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../characters.html"> Supported Characters</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html"> HTTP RESTful API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">v3</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="namespace.html">Namespace</a></li>
<li class="toctree-l3"><a class="reference internal" href="lifecycle.html">Lifecycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="preferences.html">Preferences</a></li>
<li class="toctree-l3"><a class="reference internal" href="stream.html">Stream</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataset.html">Dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="query.html">Query</a></li>
<li class="toctree-l3"><a class="reference internal" href="service.html">Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">Metrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#metrics-data">Metrics Data</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#available-contexts">Available Contexts</a></li>
<li class="toctree-l5"><a class="reference internal" href="#available-system-metrics">Available System Metrics</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#searches-and-queries">Searches and Queries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#search-for-contexts">Search for Contexts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#search-for-metrics">Search for Metrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#querying-a-metric">Querying A Metric</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#query-tips">Query Tips</a></li>
<li class="toctree-l5"><a class="reference internal" href="#querying-for-multiple-time-series">Querying for Multiple Time-series</a></li>
<li class="toctree-l5"><a class="reference internal" href="#querying-by-a-time-range">Querying by a Time Range</a></li>
<li class="toctree-l5"><a class="reference internal" href="#querying-by-run-id">Querying by Run-ID</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="monitor.html">Monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="transactions.html">Transactions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../http-restful-api-v2/index.html">v2 (Deprecated)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../javadocs/index.html"> Javadocs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../java-client-api.html"> Java Client API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cli-api.html"> Command Line Interface API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../licenses/index.html"> Trademarks, Licenses, and Dependencies</a></li>
</ul>

</nav>
  <h4>Previous Topic</h4>
  <p class="topless"><a href="logging.html"
                        title="Previous Chapter">Logging HTTP RESTful API</a></p>
  <h4>Next Topic</h4>
  <p class="topless"><a href="monitor.html"
                        title="Next Chapter">Monitor HTTP RESTful API</a></p>
  <div role="note" aria-label="downloads links">
    <h3>Downloads</h3>
    <ul class="this-page-menu">
      <li><a href="http://docs.cask.co/cdap/2.8.3/cdap-docs-2.8.3-web.zip"
            rel="nofollow">Zip Archive of CDAP Documentation</a></li>
    </ul>
   </div>
  
<div id="searchbox" style="display: none" role="search">
  <h3>Quick Search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;margin:0px auto;}
.tg td{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg th{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg .tg-s6z2{text-align:center;}
.tg .tg-0ord{text-align:right;}
.tg a{font-weight:bold;}
</style>
<table class="tg" width= 100%>
  <tr>
    <th class="tg-031e">Previous Topic: 
    <a title="Logging HTTP RESTful API" href="logging.html" />Logging HTTP RESTful API</a>&nbsp;&nbsp;
    
    </th>
    <th class="tg-s6z2">
        Copyright &copy; 2014-2016 Cask Data, Inc.
    
    </th>
    <th class="tg-0ord">&nbsp;&nbsp;Next Topic:
    <a title="Monitor HTTP RESTful API" href="monitor.html" />Monitor HTTP RESTful API</a>
    
    </th>
  </tr>
</table>

    </div>
  </body>
</html>