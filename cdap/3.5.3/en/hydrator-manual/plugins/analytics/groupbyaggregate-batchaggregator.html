<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KWLFGH');</script>
    <!-- End Google Tag Manager -->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    
    
    <meta name="git_release" content="3.5.3">
    <meta name="git_hash" content="df76fc573ba695366c529aad811217c43a173769">
    <meta name="git_timestamp" content="2017-01-21 16:09:27 -0800">
    <title>GroupBy Aggregate &mdash; Cask Data Application Platform 3.5.3 Documentation</title>

    <link rel="canonical" href="http://docs.cask.co/cdap/3.5.3/en/hydrator-manual/plugins/analytics/groupbyaggregate-batchaggregator.html">

    
    <link rel="stylesheet" href="../../_static/cdap.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/annotator.min.css" type="text/css" />



    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '3.5.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/copy-to-clipboard.js"></script>
    <script type="text/javascript" src="../../_static/tabbed-parsed-literal.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Cask Data Application Platform 3.5.3 Documentation" href="../../index.html" />
    <link rel="up" title="Analytic Plugins" href="index.html" />
    <link rel="next" title="Joiner" href="joiner-batchjoiner.html" />
    <link rel="prev" title="Distinct Aggregator" href="distinct-batchaggregator.html" /> 
  </head>
  <body role="document">

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KWLFGH"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="joiner-batchjoiner.html" title="Joiner"
             accesskey="N">Next</a> |</li>
        <li class="right" >
          <a href="distinct-batchaggregator.html" title="Distinct Aggregator"
             accesskey="P">Previous</a> |</li>
        
        <script type="text/javascript" src="../../_static/version-menu.js"></script>
        <script src="http://docs.cask.co/cdap/json-versions.js"/></script>
        <script>window.setVersion('3.5.3');</script>
       
        <li><a href="../../table-of-contents.html">Cask Hydrator</a> &raquo;</li>
          <li><a href="../index.html" >Plugin Reference</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Analytic Plugins</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div id="documentwrapper" class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="groupby-aggregate">
<span id="groupby-aggregate"></span><h1><a class="headerlink" href="#groupby-aggregate" title="Perma-link to this heading">ðŸ”—</a>GroupBy Aggregate</h1>
<div class="section" id="description">
<span id="description"></span><h2><a class="headerlink" href="#description" title="Perma-link to this heading">ðŸ”—</a>Description</h2>
<p>Groups by one or more fields, then performs one or more aggregate functions on each group.
Supports <code class="docutils literal"><span class="pre">avg</span></code>, <code class="docutils literal"><span class="pre">count</span></code>, <code class="docutils literal"><span class="pre">count(*)</span></code>, <code class="docutils literal"><span class="pre">first</span></code>, <code class="docutils literal"><span class="pre">last</span></code>, <code class="docutils literal"><span class="pre">max</span></code>, <code class="docutils literal"><span class="pre">min</span></code>,<code class="docutils literal"><span class="pre">sum</span></code> as aggregate functions.</p>
</div>
<div class="section" id="use-case">
<span id="use-case"></span><h2><a class="headerlink" href="#use-case" title="Perma-link to this heading">ðŸ”—</a>Use Case</h2>
<p>The transform is used when you want to calculate some basic aggregations in your data similar
to what you could do with a group-by query in SQL.</p>
</div>
<div class="section" id="properties">
<span id="properties"></span><h2><a class="headerlink" href="#properties" title="Perma-link to this heading">ðŸ”—</a>Properties</h2>
<p><strong>groupByFields:</strong> Comma-separated list of fields to group by.
Records with the same value for all these fields will be grouped together.
Records output by this aggregator will contain all the group by fields and aggregate fields.
For example, if grouping by the <code class="docutils literal"><span class="pre">user</span></code> field and calculating an aggregate <code class="docutils literal"><span class="pre">numActions:count(*)</span></code>,
output records will have a <code class="docutils literal"><span class="pre">user</span></code> field and a <code class="docutils literal"><span class="pre">numActions</span></code> field.</p>
<p><strong>aggregates:</strong> Aggregates to compute on each group of records.
Supported aggregate functions are <code class="docutils literal"><span class="pre">avg</span></code>, <code class="docutils literal"><span class="pre">count</span></code>, <code class="docutils literal"><span class="pre">count(*)</span></code>, <code class="docutils literal"><span class="pre">first</span></code>, <code class="docutils literal"><span class="pre">last</span></code>, <code class="docutils literal"><span class="pre">max</span></code>, <code class="docutils literal"><span class="pre">min</span></code>,<code class="docutils literal"><span class="pre">sum</span></code>.
A function must specify the field it should be applied on, as well as the name it should be called.
Aggregates are specified using the syntax <code class="docutils literal"><span class="pre">name:function(field)[,</span> <span class="pre">other</span> <span class="pre">aggregates]</span></code>.
For example, <code class="docutils literal"><span class="pre">avgPrice:avg(price),cheapest:min(price)</span></code> will calculate two aggregates.
The first will create a field called <code class="docutils literal"><span class="pre">avgPrice</span></code> that is the average of all <code class="docutils literal"><span class="pre">price</span></code> fields in the group.
The second will create a field called <code class="docutils literal"><span class="pre">cheapest</span></code> that contains the minimum <code class="docutils literal"><span class="pre">price</span></code> field in the group.
The count function differs from count(<em>) in that it contains non-null values of a specific field,
while count(</em>) will count all records regardless of value.</p>
<p><strong>numPartitions:</strong> Number of partitions to use when grouping fields. If not specified, the execution
framework will decide on the number to use.</p>
</div>
<div class="section" id="example">
<span id="example"></span><h2><a class="headerlink" href="#example" title="Perma-link to this heading">ðŸ”—</a>Example</h2>
<p>This example groups records by their <code class="docutils literal"><span class="pre">user</span></code> and <code class="docutils literal"><span class="pre">item</span></code> fields.
It then calculates two aggregates for each group. The first is a sum on <code class="docutils literal"><span class="pre">price</span></code>
and the second counts the number of records in the group.</p>
<pre class="literal-block">
{
    &quot;name&quot;: &quot;GroupByAggregate&quot;,
    &quot;type&quot;: &quot;batchaggregator&quot;,
    &quot;properties&quot;: {
        &quot;groupByFields&quot;: &quot;user,item&quot;,
        &quot;aggregates&quot;: &quot;totalSpent:sum(price),numPurchased:count(*)&quot;
    }
}
</pre>
<p>For example, suppose the aggregator receives input records where each record represents a purchase:</p>
<pre class="literal-block">
+========================+
| user  | item   | price |
+========================+
| bob   | donut  | 0.80  |
| bob   | coffee | 2.05  |
| bob   | donut  | 1.50  |
| bob   | donut  | 0.50  |
| alice | tea    | 1.99  |
| alice | cookie | 0.50  |
+========================+
</pre>
<p>Output records will contain all group fields in addition to a field for each aggregate:</p>
<pre class="literal-block">
+============================================+
| user  | item   | totalSpent | numPurchased |
+============================================+
| bob   | donut  | 2.80       | 3            |
| bob   | coffee | 2.05       | 1            |
| alice | tea    | 1.99       | 1            |
| alice | cookie | 0.50       | 1            |
+============================================+
</pre>
<hr class="docutils" />
<ul class="simple">
<li>Hydrator Plugin Type: batchaggregator</li>
<li>Hydrator Version: 1.4.1</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

  <div role="note" aria-label="manuals links">
    <h3><a href="../../table-of-contents/../../index.html" rel="nofollow">CDAP Documentation v3.5.3</a></h3>
    
    <ul class="this-page-menu">
      <li><div class=""></div><a href="../../table-of-contents/../../introduction/index.html" rel="nofollow">Introduction to CDAP</a></li>
      <li><div class=""></div><a href="../../table-of-contents/../../developers-manual/index.html" rel="nofollow">Developersâ€™ Manual</a></li>
      <li><div class=""></div><a href="../../table-of-contents/../../admin-manual/index.html" rel="nofollow">Administration Manual</a></li>
      <li><div class=""></div><a href="../../table-of-contents/../../integrations/index.html" rel="nofollow">Integrations</a></li>
      <li><div class=""></div><a href="../../table-of-contents/../../examples-manual/index.html" rel="nofollow">Examples, Guides, and Tutorials</a></li>
      <li><div class=""></div><a href="../../table-of-contents/../../reference-manual/index.html" rel="nofollow">Reference Manual</a></li>
      <li><div class=""></div><a href="../../table-of-contents/../../faqs/index.html" rel="nofollow">FAQs</a></li>
      <li><div class=""></div><a href="../../table-of-contents/../../reference-manual/release-notes.html" rel="nofollow">Release Notes</a></li>
      <li><div class=""></div><a href="../../table-of-contents/../../reference-manual/glossary.html" rel="nofollow">Glossary</a></li>
      <li><div class=""></div><a href="../../table-of-contents/../../search.html" rel="nofollow">Search</a></li>
    </ul>
    <h3 class="cdap-extensions">CDAP Extensions</h3>
    
    <ul class="this-page-menu">
      <li><div class=""></div><a href="../../table-of-contents/../../hydrator-manual/index.html" rel="nofollow">Cask Hydrator</a></li>
      <li><div class=""></div><a href="../../table-of-contents/../../tracker-manual/index.html" rel="nofollow">Cask Tracker</a></li>
    </ul>
  </div>
    
  <h3 class="pagenavtitle"><a href="../../table-of-contents.html">Cask Hydrator: Table&nbsp;of&nbsp;Contents</a></h3>
    <nav class="pagenav">
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html"> Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts-design.html"> Concepts and Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started.html"> Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../studio.html"> Hydrator Studio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../creating-pipelines.html"> Creating Pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../running-pipelines.html"> Running Pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plugin-management.html"> Plugin Management</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html"> Plugin Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../actions/index.html"> Action Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sources/index.html"> Source Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transforms/index.html"> Transform Plugins</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html"> Analytic Plugins</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="deduplicate-batchaggregator.html">Deduplicate</a></li>
<li class="toctree-l3"><a class="reference internal" href="distinct-batchaggregator.html">Distinct Aggregator</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">GroupBy Aggregate</a></li>
<li class="toctree-l3"><a class="reference internal" href="joiner-batchjoiner.html">Joiner</a></li>
<li class="toctree-l3"><a class="reference internal" href="naivebayesclassifier-sparkcompute.html">Naive Bayes Classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="rowdenormalizer-batchaggregator.html">Row Denormalizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="DPB-naivebayestrainer-sparksink.html">Naive Bayes Trainer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sinks/index.html"> Sink Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shared-plugins/index.html"> Shared Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../post-run-plugins/index.html"> Post-run Plugins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developing-pipelines.html"> Developing Pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developing-plugins/index.html"> Developing Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-hydrator-works.html"> How Hydrator Works</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faqs.html"> FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html"> Glossary</a></li>
</ul>
 
    </nav>
  
<div id="searchbox" style="display: none" role="search">
  <h3>Quick Search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <div role="note" aria-label="downloads links">
    <h3>Downloads</h3>
    <ul class="this-page-menu">
      <li><a href="http://docs.cask.co/cdap/3.5.3/cdap-docs-3.5.3-web.zip"
            rel="nofollow">Zip Archive of CDAP Documentation</a></li>
    </ul>
   </div>
<div role="note" aria-label="other links">
    <h3><a href="http://docs.cask.co/" target="_blank">Documentation</a></h3>
    <ul class="this-page-menu">
        <li><a href="http://docs.cask.co/cdap/index.html" target="_blank">CDAP</a></li>
        <li><a href="http://docs.cask.co/coopr/index.html" target="_blank">Coopr</a></li>
        <li><a href="http://docs.cask.co/tigon/index.html" target="_blank">Tigon</a></li>
    </ul>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;margin:0px auto;}
.tg td{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg th{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg .tg-s6z2{text-align:center;}
.tg .tg-0ord{text-align:right;}
.tg a{font-weight:bold;}
</style>
<table class="tg" width= 100%>

  <tr>
    <th class="tg-031e">Previous Topic: 
    <a title="Distinct Aggregator" href="distinct-batchaggregator.html" />Distinct Aggregator</a>&nbsp;&nbsp;
    </th>
    
    <th class="tg-s6z2">
        Copyright &copy; 2014-2017 Cask Data, Inc.
      &bull; Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </th>
    <th class="tg-0ord">&nbsp;&nbsp;Next Topic:
    <a title="Joiner" href="joiner-batchjoiner.html" />Joiner</a>
    </th>

  </tr>
</table>

    </div>
  </body>
</html>