<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
    <meta name="robots" content="noindex, nofollow">

<!-- Generated by javadoc (version 1.7.0_80) on Tue Dec 15 12:08:39 PST 2015 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>HashPartition (CDAP API 2.8.2 API)</title>
<meta name="date" content="2015-12-15">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="HashPartition (CDAP API 2.8.2 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/HashPartition.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../co/cask/cdap/api/annotation/Handle.html" title="annotation in co.cask.cdap.api.annotation"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../co/cask/cdap/api/annotation/Output.html" title="annotation in co.cask.cdap.api.annotation"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?co/cask/cdap/api/annotation/HashPartition.html" target="_top">Frames</a></li>
<li><a href="HashPartition.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#annotation_type_required_element_summary">Required</a>&nbsp;|&nbsp;</li>
<li>Optional</li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#annotation_type_element_detail">Element</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">co.cask.cdap.api.annotation</div>
<h2 title="Annotation Type HashPartition" class="title">Annotation Type HashPartition</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre><a href="http://download.oracle.com/javase/6/docs/api/java/lang/annotation/Retention.html?is-external=true" title="class or interface in java.lang.annotation">@Retention</a>(<a href="http://download.oracle.com/javase/6/docs/api/java/lang/annotation/Retention.html?is-external=true#value()" title="class or interface in java.lang.annotation">value</a>=<a href="http://download.oracle.com/javase/6/docs/api/java/lang/annotation/RetentionPolicy.html?is-external=true#RUNTIME" title="class or interface in java.lang.annotation">RUNTIME</a>)
<a href="http://download.oracle.com/javase/6/docs/api/java/lang/annotation/Target.html?is-external=true" title="class or interface in java.lang.annotation">@Target</a>(<a href="http://download.oracle.com/javase/6/docs/api/java/lang/annotation/Target.html?is-external=true#value()" title="class or interface in java.lang.annotation">value</a>=<a href="http://download.oracle.com/javase/6/docs/api/java/lang/annotation/ElementType.html?is-external=true#METHOD" title="class or interface in java.lang.annotation">METHOD</a>)
public @interface <span class="strong">HashPartition</span></pre>
<div class="block">Defines the strategy used when reading data from a <a href="../../../../../co/cask/cdap/api/flow/flowlet/Flowlet.html" title="interface in co.cask.cdap.api.flow.flowlet"><code>Flowlet's</code></a> input
 as hash partitioning.

 <p>
 The input is partitioned among the running <a href="../../../../../co/cask/cdap/api/flow/flowlet/Flowlet.html" title="interface in co.cask.cdap.api.flow.flowlet"><code>Flowlets</code></a> using the
 partitioning key. If the partitioning key is not emitted, then the input is treated as part of partition zero.
 </p>
 
 <p>
 If we have 3 instances of a Flowlet, with round-robin partitioning, every instance will receive every third word. 
 For example, for the sequence of words in the sentence, &quot;I scream, you scream, we all scream for ice 
 cream&quot;:
 </p>
 
 <ul>
 <li>
 The first instance receives these words: I scream scream cream
 </li>
 <li>
 The second instance receives these words: scream we for
 </li>
 </ul>

 <p>
 The potential problem with this is that both instances might attempt to increment the counter for the word 
 &quot;scream&quot; at the same time, and that may lead to a write conflict. To avoid write conflicts, we can use 
 hash partitioning:

 <pre>
 <code>
 @HashPartition("wordHash")
 @ProcessInput("wordOut")
 public void process(String word) throws OperationException {
   this.wordCountsTable.increment(Bytes.toBytes(word), 1L);
 }
 </code>
 </pre>
 
 <p>
 Now only one of the Flowlet instances will receive the word &quot;scream&quot;, and there will be no write 
 conflicts. Note that in order to use hash partitioning, the emitting Flowlet must annotate each data object with the
 partitioning key: 
 </p>
 
 <pre>
 <code>
 @Output("wordOut")
 private OutputEmitter&lt;String> wordOutput;
   ...
 public void process(StreamEvent event) throws OperationException {
   ...
   // emit the word with the partitioning key “wordHash” 
   // (the partitioning key "wordHash" was declared in the earlier code snippet above)
   wordOutput.emit(word, "wordHash", word.hashCode());
 }
 </code>
 </pre>

 <p>
 Note that the emitter must use the same name ("wordHash") for the key that the consuming Flowlet specifies 
 as the partitioning key. If the output is connected to more than one Flowlet, you can also annotate a data 
 object with multiple hash keys – each consuming Flowlet can then use different partitioning. This is useful 
 if you want to aggregate by multiple keys; for example, if you want to count purchases by product ID as well 
 as by customer ID.
 </p>

 <p>
 Partitioning can be combined with batch execution: 
 </p>

 <pre>
 <code>
 @Batch(100)
 @HashPartition("wordHash")
 @ProcessInput("wordOut")
 public void process(Iterator&lt;String> words) throws OperationException {
   ...
 }
 </code>
 </pre></div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../co/cask/cdap/api/annotation/Batch.html" title="annotation in co.cask.cdap.api.annotation"><code>Batch</code></a>, 
<a href="../../../../../co/cask/cdap/api/annotation/RoundRobin.html" title="annotation in co.cask.cdap.api.annotation"><code>RoundRobin</code></a>, 
<a href="../../../../../co/cask/cdap/api/annotation/ProcessInput.html" title="annotation in co.cask.cdap.api.annotation"><code>ProcessInput</code></a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== ANNOTATION TYPE REQUIRED MEMBER SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="annotation_type_required_element_summary">
<!--   -->
</a>
<h3>Required Element Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Required Element Summary table, listing required elements, and an explanation">
<caption><span>Required Elements</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Required Element and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../co/cask/cdap/api/annotation/HashPartition.html#value()">value</a></strong></code>
<div class="block">Declare the name of the partitioning key to the process methods
 across multiple instances of a <a href="../../../../../co/cask/cdap/api/flow/flowlet/Flowlet.html" title="interface in co.cask.cdap.api.flow.flowlet"><code>Flowlet</code></a>.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ ANNOTATION TYPE MEMBER DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="annotation_type_element_detail">
<!--   -->
</a>
<h3>Element Detail</h3>
<a name="value()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>value</h4>
<pre>public abstract&nbsp;<a href="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;value</pre>
<div class="block">Declare the name of the partitioning key to the process methods
 across multiple instances of a <a href="../../../../../co/cask/cdap/api/flow/flowlet/Flowlet.html" title="interface in co.cask.cdap.api.flow.flowlet"><code>Flowlet</code></a>.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/HashPartition.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../co/cask/cdap/api/annotation/Handle.html" title="annotation in co.cask.cdap.api.annotation"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../co/cask/cdap/api/annotation/Output.html" title="annotation in co.cask.cdap.api.annotation"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?co/cask/cdap/api/annotation/HashPartition.html" target="_top">Frames</a></li>
<li><a href="HashPartition.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#annotation_type_required_element_summary">Required</a>&nbsp;|&nbsp;</li>
<li>Optional</li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#annotation_type_element_detail">Element</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2015 <a href="http://cask.co" target="_blank">Cask Data, Inc.</a> Licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank">Apache License, Version 2.0</a>.</small></p>
</body>
</html>
