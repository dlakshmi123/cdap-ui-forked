<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="robots" content="noindex, nofollow">

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Cask Data, Inc." name="author" />
<meta content="Copyright © 2015 Cask Data, Inc." name="copyright" />
<script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-55081520-2']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    
    <meta name="git_release" content="3.1.1">
    <meta name="git_hash" content="3082743cfcea9f4e2e45f21875199f93d136b409">
    <meta name="git_timestamp" content="2015-08-14 16:55:12 -0700">
    <title>ObjectMappedTable Exploration &mdash; Cask Data Application Platform 3.1.1 Documentation</title>
    
    <link rel="stylesheet" href="../_static/cdap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    



    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Cask Data Application Platform 3.1.1 Documentation" href="../index.html" />
    <link rel="up" title="Data Exploration" href="index.html" />
    <link rel="next" title="Custom Dataset Exploration" href="custom-datasets.html" />
    <link rel="prev" title="Table Exploration" href="tables.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="custom-datasets.html" title="Custom Dataset Exploration"
             accesskey="N">Next</a> |</li>
        <li class="right" >
          <a href="tables.html" title="Table Exploration"
             accesskey="P">Previous</a> |</li>
        
        <script type="text/javascript" src="../_static/version-menu.js"></script>
        <script src="http://docs.cask.co/cdap/json-versions.js"/></script>
        <script>window.setVersion('3.1.1');</script>
       
        <li><a href="../table-of-contents.html">CDAP Developers’ Manual</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Data Exploration</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="objectmappedtable-exploration">
<span id="object-mapped-table-exploration"></span><h1>ObjectMappedTable Exploration<a class="headerlink" href="#objectmappedtable-exploration" title="Permalink to this headline">¶</a></h1>
<p>An <code class="docutils literal"><span class="pre">ObjectMappedTable</span></code> is a system dataset that can write Java objects to a Table
by mapping object fields to Table columns. It can also be explored in an ad-hoc manner.</p>
<div class="section" id="creating-an-objectmappedtable">
<h2>Creating an ObjectMappedTable<a class="headerlink" href="#creating-an-objectmappedtable" title="Permalink to this headline">¶</a></h2>
<p>When creating an <code class="docutils literal"><span class="pre">ObjectMappedTable</span></code> in your application, you must specify the Java type
that will be stored in your table:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">()</span> <span class="o">{</span>
  <span class="k">try</span> <span class="o">{</span>
    <span class="n">createDataset</span><span class="o">(</span><span class="s">&quot;purchases&quot;</span><span class="o">,</span> <span class="n">ObjectMappedTable</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
                  <span class="n">ObjectMappedTableProperties</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
                    <span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="n">Purchase</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">build</span><span class="o">()</span>
                 <span class="o">);</span>
  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">UnsupportedTypeException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// This exception is thrown by ObjectMappedTable if its parameter type cannot be</span>
    <span class="c1">// (de)serialized (for example, if it is an interface and not a class, then there is</span>
    <span class="c1">// no auto-magic way deserialize an object.) In this case that will not happen</span>
    <span class="c1">// because Purchase is an actual class.</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>CDAP will derive the record schema from the specified type. For example, if the <code class="docutils literal"><span class="pre">Purchase</span></code> class is defined as:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Purchase</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">customer</span><span class="o">,</span> <span class="n">product</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">quantity</span><span class="o">,</span> <span class="n">price</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">purchaseTime</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">catalogId</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">Purchase</span><span class="o">(</span><span class="n">String</span> <span class="n">customer</span><span class="o">,</span> <span class="n">String</span> <span class="n">product</span><span class="o">,</span> <span class="kt">int</span> <span class="n">quantity</span><span class="o">,</span> <span class="kt">int</span> <span class="n">price</span><span class="o">,</span> <span class="kt">long</span> <span class="n">purchaseTime</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">customer</span> <span class="o">=</span> <span class="n">customer</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">product</span> <span class="o">=</span> <span class="n">product</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">quantity</span> <span class="o">=</span> <span class="n">quantity</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">price</span> <span class="o">=</span> <span class="n">price</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">purchaseTime</span> <span class="o">=</span> <span class="n">purchaseTime</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">catalogId</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>CDAP will map each object field to a Table column and the schema will be:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="o">(</span><span class="n">key</span> <span class="n">BINARY</span><span class="o">,</span> <span class="n">catalogid</span> <span class="n">STRING</span><span class="o">,</span> <span class="n">customer</span> <span class="n">STRING</span><span class="o">,</span> <span class="n">price</span> <span class="n">INT</span><span class="o">,</span> <span class="n">product</span> <span class="n">STRING</span><span class="o">,</span> <span class="n">purchasetime</span> <span class="n">BIGINT</span><span class="o">,</span> <span class="n">quantity</span> <span class="n">INT</span><span class="o">)</span>
</pre></div>
</div>
<p>Note that all column names have been changed to lowercase letters. This is because Hive column names are case-insensitive.
In addition to the object fields, the object key has been inserted into the schema as a binary column <code class="docutils literal"><span class="pre">key</span></code>.</p>
<p>If you wish to name the key column differently, perhaps because your object already contains a field named &#8220;key&#8221;, you
can do so by providing an additional property when creating your dataset. You can also set the key type to <code class="docutils literal"><span class="pre">STRING</span></code>
instead of <code class="docutils literal"><span class="pre">BINARY</span></code> if desired:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">()</span> <span class="o">{</span>
  <span class="k">try</span> <span class="o">{</span>
    <span class="n">createDataset</span><span class="o">(</span><span class="s">&quot;purchases&quot;</span><span class="o">,</span> <span class="n">ObjectMappedTable</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
                  <span class="n">ObjectMappedTableProperties</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
                    <span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="n">Purchase</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">setRowKeyExploreName</span><span class="o">(</span><span class="s">&quot;rowkey&quot;</span><span class="o">)</span>
                    <span class="c1">// only STRING and BINARY are supported.</span>
                    <span class="o">.</span><span class="na">setRowKeyExploreType</span><span class="o">(</span><span class="n">Schema</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">STRING</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">build</span><span class="o">()</span>
                 <span class="o">);</span>
  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">UnsupportedTypeException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// This exception is thrown by ObjectMappedTable if its parameter type cannot be</span>
    <span class="c1">// (de)serialized (for example, if it is an interface and not a class, then there is</span>
    <span class="c1">// no auto-magic way deserialize an object.) In this case that will not happen</span>
    <span class="c1">// because Purchase is an actual class.</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Creating the dataset in this manner would result in a different column name and type for the object key:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="o">(</span><span class="n">rowkey</span> <span class="n">STRING</span><span class="o">,</span> <span class="n">catalogid</span> <span class="n">STRING</span><span class="o">,</span> <span class="n">customer</span> <span class="n">STRING</span><span class="o">,</span> <span class="n">price</span> <span class="n">INT</span><span class="o">,</span> <span class="n">product</span> <span class="n">STRING</span><span class="o">,</span> <span class="n">purchasetime</span> <span class="n">BIGINT</span><span class="o">,</span> <span class="n">quantity</span> <span class="n">INT</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="limitations">
<span id="object-mapped-table-exploration-sql-limitations"></span><h2>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>The record type must be a structured type, that is, a Java class with fields. This is because SQL tables require
a structure type at the top level. The fields must be primitives. That is, they must be an int, Integer,
float, Float, double, Double, bool, Boolean, String, byte[], or ByteBuffer. UUID is supported and
will translate into a binary field.</li>
<li>The record type must be that of an actual Java class, not an interface. The reason is that interfaces only define
methods but not fields; hence, reflection would not be able to derive any fields or types from the interface.</li>
<li>Fields of a class that are declared static or transient are ignored during schema generation. This means that the
record type must have at least one non-transient and non-static field. For example,
the <code class="docutils literal"><span class="pre">java.util.Date</span></code> class has only static and transient fields. Therefore a record type of <code class="docutils literal"><span class="pre">Date</span></code> is not
supported and will result in an exception when the dataset is created.</li>
<li>You cannot insert data into an <code class="docutils literal"><span class="pre">ObjectMappedTable</span></code> using SQL.</li>
</ul>
</div>
<div class="section" id="formulating-queries">
<h2>Formulating Queries<a class="headerlink" href="#formulating-queries" title="Permalink to this headline">¶</a></h2>
<p>When creating your queries, keep these limitations in mind:</p>
<ul class="simple">
<li>The query syntax of CDAP is a subset of the variant of SQL that was first defined by Apache Hive.</li>
<li>The SQL commands <code class="docutils literal"><span class="pre">UPDATE</span></code> and <code class="docutils literal"><span class="pre">DELETE</span></code> are not allowed on CDAP datasets.</li>
<li>When addressing your datasets in queries, you need to prefix the dataset name with the CDAP
namespace <code class="docutils literal"><span class="pre">dataset_</span></code>. For example, if your dataset is named <code class="docutils literal"><span class="pre">Purchases</span></code>, then the corresponding table
name is <code class="docutils literal"><span class="pre">dataset_purchases</span></code>. Note that the table name is lower-case.</li>
<li>If your dataset name contains a &#8216;.&#8217; or a &#8216;-&#8216;, those characters will be converted to &#8216;_&#8217; for the Hive
table name. For example, if your dataset is named <code class="docutils literal"><span class="pre">my-table.name</span></code>, the corresponding Hive table
name will be <code class="docutils literal"><span class="pre">dataset_my_table_name</span></code>. Beware of name collisions. For example, <code class="docutils literal"><span class="pre">my.table</span></code> will
use the same Hive table name as <code class="docutils literal"><span class="pre">my_table</span></code>.</li>
</ul>
<p>For more examples of queries, please refer to the <a class="reference external" href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DML">Hive language manual</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="manuals links">
    <h3><a href="../table-of-contents/../../index.html"
        rel="nofollow">CDAP Documentation v3.1.1</a></h3>
    <ul class="this-page-menu">
      <li><div class=""></div><a href="../table-of-contents/../../index.html"
            rel="nofollow">Overview</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../introduction/index.html"
            rel="nofollow">Introduction to CDAP</a></li>
            
      <li><div class=""></div><b><a href="../table-of-contents/../../developers-manual/index.html"
            rel="nofollow">Developers’ Manual</a></b></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../application-templates/index.html"
            rel="nofollow">Application Templates</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../admin-manual/index.html"
            rel="nofollow">Administration Manual</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../integrations/index.html"
            rel="nofollow">Integrations</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../examples-manual/index.html"
            rel="nofollow">Examples, Guides, and Tutorials</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../reference-manual/index.html"
            rel="nofollow">Reference Manual</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../reference-manual/release-notes.html"
            rel="nofollow">Release Notes</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../reference-manual/glossary.html"
            rel="nofollow">Glossary</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../reference-manual/faq.html"
            rel="nofollow">FAQ</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../search.html"
            rel="nofollow">Search</a></li>
    </ul>
   </div><!--
  Copyright © 2014-2015 Cask Data, Inc.

  Licensed under the Apache License, Version 2.0 (the "License"); you may not
  use this file except in compliance with the License. You may obtain a copy of
  the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
  License for the specific language governing permissions and limitations under
  the License.
-->


    
<h3 class="pagenavtitle"><a href="../table-of-contents.html">Developers’ Manual: Table&nbsp;of&nbsp;Contents</a></h3>
<nav class="pagenav">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html"> Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/index.html"> Getting Started Developing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html"> Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building-blocks/index.html"> Building Blocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html"> Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html"> Testing and Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ingesting-tools/index.html"> Ingesting Data</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html"> Data Exploration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="streams.html"> Stream Exploration</a></li>
<li class="toctree-l2"><a class="reference internal" href="filesets.html"> Fileset Exploration</a></li>
<li class="toctree-l2"><a class="reference internal" href="tables.html"> Table Exploration</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href=""> ObjectMappedTable Exploration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-an-objectmappedtable">Creating an ObjectMappedTable</a></li>
<li class="toctree-l3"><a class="reference internal" href="#limitations">Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#formulating-queries">Formulating Queries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="custom-datasets.html"> Custom Dataset Exploration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/index.html"> Advanced Topics</a></li>
</ul>

</nav>
  <h4>Previous Topic</h4>
  <p class="topless"><a href="tables.html"
                        title="Previous Chapter">Table Exploration</a></p>
  <h4>Next Topic</h4>
  <p class="topless"><a href="custom-datasets.html"
                        title="Next Chapter">Custom Dataset Exploration</a></p>
  <div role="note" aria-label="downloads links">
    <h3>Downloads</h3>
    <ul class="this-page-menu">
      <li><a href="http://docs.cask.co/cdap/3.1.1/cdap-docs-3.1.1-web.zip"
            rel="nofollow">Zip Archive of CDAP Documentation</a></li>
    </ul>
   </div>
  
<div id="searchbox" style="display: none" role="search">
  <h3>Quick Search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<div role="note" aria-label="other links">
    <h3><a href="http://docs.cask.co/" target="_blank">Documentation</a></h3>
    <ul class="this-page-menu">
        <li><a href="http://docs.cask.co/cdap/index.html" target="_blank">CDAP</a></li>
        <li><a href="http://docs.cask.co/coopr/index.html" target="_blank">Coopr</a></li>
        <li><a href="http://docs.cask.co/tephra/index.html" target="_blank">Tephra</em></a></li>
        <li><a href="http://docs.cask.co/tigon/index.html" target="_blank">Tigon</a></li>
    </ul>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;margin:0px auto;}
.tg td{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg th{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg .tg-s6z2{text-align:center;}
.tg .tg-0ord{text-align:right;}
.tg a{font-weight:bold;}
</style>
<table class="tg" width= 100%>
  <tr>
    <th class="tg-031e">Previous Topic: 
    <a title="Table Exploration" href="tables.html" />Table Exploration</a>&nbsp;&nbsp;
    
    </th>
    <th class="tg-s6z2">
        Copyright &copy; 2014-2015 Cask Data, Inc.
    
    </th>
    <th class="tg-0ord">&nbsp;&nbsp;Next Topic:
    <a title="Custom Dataset Exploration" href="custom-datasets.html" />Custom Dataset Exploration</a>
    
    </th>
  </tr>
</table>

    </div>
  </body>
</html>