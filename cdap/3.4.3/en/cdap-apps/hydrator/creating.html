<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="robots" content="noindex, nofollow">

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Cask Data, Inc." name="author" />
<meta content="Copyright © 2015-2016 Cask Data, Inc." name="copyright" />

    
    
    <meta name="git_release" content="3.4.3">
    <meta name="git_hash" content="687785ab5647ce93ed5077fef6ced9ee059bad6a">
    <meta name="git_timestamp" content="2016-06-30 17:45:25 -0700">
    <title>Creating an ETL Application &mdash; Cask Data Application Platform 3.4.3 Documentation</title>
    
    <link rel="stylesheet" href="../_static/cdap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />



    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.4.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/copy-to-clipboard.js"></script>
    <script type="text/javascript" src="../_static/tabbed-parsed-literal.js"></script>
   
    <!-- Google Tag Manager start -->
    <script>dataLayer = [];</script>
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PBZ3JL"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PBZ3JL');</script>
    <!-- Google Tag Manager end -->
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Cask Data Application Platform 3.4.3 Documentation" href="../index.html" />
    <link rel="up" title="Cask Hydrator and ETL Pipelines" href="index.html" />
    <link rel="next" title="Creating Custom ETL Plugins" href="custom.html" />
    <link rel="prev" title="ETL Upgrade Procedure" href="upgrade.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="custom.html" title="Creating Custom ETL Plugins"
             accesskey="N">Next</a> |</li>
        <li class="right" >
          <a href="upgrade.html" title="ETL Upgrade Procedure"
             accesskey="P">Previous</a> |</li>
        
        <script type="text/javascript" src="../_static/version-menu.js"></script>
        <script src="http://docs.cask.co/cdap/json-versions.js"/></script>
        <script>window.setVersion('3.4.3');</script>
       
        <li><a href="../table-of-contents.html">CDAP CDAP Applications</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Cask Hydrator and ETL Pipelines</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="creating-an-etl-application">
<span id="cdap-apps-etl-creating"></span><h1>Creating an ETL Application<a class="headerlink" href="#creating-an-etl-application" title="Permalink to this headline">¶</a></h1>
<p>Applications can be created using the <a class="reference external" href="../source/../../reference-manual/http-restful-api/lifecycle.html#http-restful-api-lifecycle-create-app" title="(in Cask Data Application Platform v3.4.3)"><span class="xref std std-ref">Lifecycle RESTful API</span></a>,
the <a class="reference external" href="../source/../../reference-manual/cli-api.html#cli" title="(in Cask Data Application Platform v3.4.3)"><span class="xref std std-ref">CDAP CLI</span></a>, or the <a class="reference external" href="../source/../../admin-manual/operations/cdap-ui.html#cdap-ui" title="(in Cask Data Application Platform v3.4.3)"><span class="xref std std-ref">CDAP UI</span></a>. In order to create an application,
an application configuration is required that specifies the source, transformations and sinks
along with their properties.  (In the CDAP UI, the interface prompts you for the required
information.)</p>
<div class="section" id="configuration-file-format">
<span id="cdap-apps-etl-configuration-file-format"></span><h2>Configuration File Format<a class="headerlink" href="#configuration-file-format" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creating-an-etl-batch-application">
<h3>Creating an ETL Batch Application<a class="headerlink" href="#creating-an-etl-batch-application" title="Permalink to this headline">¶</a></h3>
<p>With an ETL Batch Application, it requires a <code class="docutils literal"><span class="pre">schedule</span></code> property with a cron entry
specifying the frequency of the Batch job run, such as every day or every hour.</p>
<p>For example, this JSON (when in a file such as <code class="docutils literal"><span class="pre">config.json</span></code>) provides a
configuration for a Batch Application that runs every minute, reading data from a stream
<em>myStream</em> and writing to a dataset (Table) called <em>myTable</em>, without any transformations:</p>
<div class="highlight container">
<pre class="literal-block">
{
  &quot;artifact&quot;: {
    &quot;name&quot;: &quot;cdap-etl-batch&quot;,
    &quot;version&quot;: &quot;3.4.3&quot;,
    &quot;scope&quot;: &quot;system&quot;
  },
  &quot;config&quot;: {
    &quot;schedule&quot;: &quot;* * * * *&quot;,
    &quot;source&quot;: {
      &quot;name&quot;: &quot;streamSource&quot;,
      &quot;plugin&quot;: {
        &quot;name&quot;: &quot;Stream&quot;,
        &quot;artifact&quot;: {
          &quot;name&quot;: &quot;core-plugins&quot;,
          &quot;version&quot;: &quot;3.4.3&quot;,
          &quot;scope&quot;: &quot;SYSTEM&quot;
        },
        &quot;properties&quot;: {
          &quot;name&quot;: &quot;myStream&quot;,
          &quot;duration&quot;: &quot;1m&quot;
        }
      }
    },
    &quot;transforms&quot;: [ ],
    &quot;sinks&quot;: [
      {
        &quot;name&quot;: &quot;tableSink&quot;,
        &quot;plugin&quot;: {
          &quot;name&quot;: &quot;Table&quot;,
          &quot;properties&quot;: {
            &quot;name&quot;: &quot;myTable&quot;,
            &quot;schema.row.field&quot;: &quot;ts&quot;
          }
        }
      }
    ],
    &quot;connections&quot;: [
      {
        &quot;from&quot;: &quot;streamSource&quot;,
        &quot;to&quot;: &quot;tableSink&quot;
      }
    ]
  }
}
</pre>
</div>
<p>The application launches a MapReduce program that runs every minute, reads data from the
stream <em>myStream</em> and writes to a Table <em>myTable</em>. A Table Sink needs a row key field to
be specified and can use the timestamp of a Stream event for that.</p>
<p>A pipeline configuration consists of stages and connections. The stages consist of a single
source, zero (or) more transforms and one (or more) sink(s). Each of these stages is
identified by a unique name and plugin.</p>
<p>A plugin object is specified by a plugin-name, a properties map and can optionally specify the artifact.
If the artifact is not specified, the application will choose the artifact with the highest version.</p>
<p>The connections field in the configuration defines the connections between the stages.
The pipeline defined by these connections must be a directed acyclic graph (or DAG).</p>
<p>To create this application, called <em>streamETLApp</em>, you can use either the HTTP RESTful API or the CDAP CLI.</p>
<ul>
<li><p class="first">Using the <a class="reference external" href="../source/../../reference-manual/http-restful-api/lifecycle.html#http-restful-api-lifecycle-create-app" title="(in Cask Data Application Platform v3.4.3)"><span class="xref std std-ref">Lifecycle RESTful API</span></a>:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -w<span class="s1">&#39;\n&#39;</span> -X PUT localhost:10000/v3/namespaces/default/apps/streamETLApp <span class="se">\</span>
<span class="go">    -H &#39;Content-Type: application/json&#39; -d @config.json</span>
</pre></div>
</div>
</li>
<li><p class="first">Using the <a class="reference external" href="../source/../../reference-manual/cli-api.html#cli" title="(in Cask Data Application Platform v3.4.3)"><span class="xref std std-ref">CDAP CLI</span></a>:</p>
<div class="highlight container">
<pre class="literal-block">
<span class="gp">$</span> cdap-cli.sh create app streamETLApp cdap-etl-batch 3.4.3 system &lt;path-to-config.json&gt;
</pre>
</div>
</li>
</ul>
<p>where <code class="docutils literal"><span class="pre">config.json</span></code> is the file that contains the application configuration.</p>
</div>
<div class="section" id="creating-an-etl-real-time-application">
<h3>Creating an ETL Real-Time Application<a class="headerlink" href="#creating-an-etl-real-time-application" title="Permalink to this headline">¶</a></h3>
<p>This next configuration creates a real-time application that reads from Twitter and writes to a
stream after performing a projection transformation:</p>
<div class="highlight container">
<pre class="literal-block">
{
  &quot;artifact&quot;: {
    &quot;name&quot;: &quot;cdap-etl-realtime&quot;,
    &quot;version&quot;: &quot;3.4.3&quot;,
    &quot;scope&quot;: &quot;system&quot;
  },
  &quot;config&quot;: {
    &quot;instances&quot;: 1,
    &quot;source&quot;: {
      &quot;name&quot;: &quot;twitterSource&quot;,
      &quot;plugin&quot;: {
        &quot;name&quot;: &quot;Twitter&quot;,
        &quot;properties&quot;: {
          &quot;AccessToken&quot;: &quot;xxx&quot;,
          &quot;AccessTokenSecret&quot;: &quot;xxx&quot;,
          &quot;ConsumerKey&quot;: &quot;xxx&quot;,
          &quot;ConsumerSecret&quot;: &quot;xxx&quot;
        }
      }
    },
    &quot;transforms&quot;: [
      {
        &quot;name&quot;: &quot;dropProjector&quot;,
        &quot;plugin&quot;: {
          &quot;name&quot;: &quot;Projection&quot;,
          &quot;properties&quot;: {
            &quot;drop&quot;: &quot;lang,time,favCount,source,geoLat,geoLong,isRetweet&quot;
          }
        }
      }
    ],
    &quot;sinks&quot;: [
      {
        &quot;name&quot;: &quot;streamSink&quot;,
        &quot;plugin&quot;: {
          &quot;name&quot;: &quot;Stream&quot;,
          &quot;properties&quot;: {
            &quot;name&quot;: &quot;twitterStream&quot;,
            &quot;body.field&quot;: &quot;tweet&quot;
          }
        }
      }
    ],
    &quot;connections&quot;: [
      {
        &quot;from&quot;: &quot;twitterSource&quot;,
        &quot;to&quot;: &quot;dropProjector&quot;
      },
      {
        &quot;from&quot;: &quot;dropProjector&quot;,
        &quot;to&quot;: &quot;streamSink&quot;
      }
    ]
  }
}
</pre>
</div>
<p>An ETL Real-Time Application expects an instance property that will create <em>N</em> instances
of the worker that run concurrently. In Standalone CDAP mode, this is implemented as
multiple threads; in Distributed CDAP mode, it will create different YARN containers. The
number of worker instances of a real-time application should not (in general) be changed
during runtime. If the number of instances needs to be changed, the worker must be
stopped, then the application configuration must be updated to the new number of instances.</p>
<p>The <code class="docutils literal"><span class="pre">instances</span></code> property value needs to be greater than 0. Note that the <code class="docutils literal"><span class="pre">instance</span></code>
property replaces the <code class="docutils literal"><span class="pre">schedule</span></code> property of an ETL Batch Application.</p>
<p>In the example code above, we will use a <em>ProjectionTransform</em> (a type of Transform) to drop certain
columns in the incoming data. A <em>StreamSink</em> in the final step needs a data field property
that it will use as the content for the data to be written.</p>
</div>
<div class="section" id="non-linear-executions-in-pipelines">
<h3>Non-linear Executions in Pipelines<a class="headerlink" href="#non-linear-executions-in-pipelines" title="Permalink to this headline">¶</a></h3>
<p>ETL Applications support directed acyclic graphs in pipelines, which allows for the
non-linear execution of pipeline stages.</p>
<div class="section" id="fork-in-pipeline">
<h4>Fork in Pipeline<a class="headerlink" href="#fork-in-pipeline" title="Permalink to this headline">¶</a></h4>
<p>In this example, a pipeline reads from the stream <code class="docutils literal"><span class="pre">purchaseStats</span></code>. It writes the stream events
to the table <code class="docutils literal"><span class="pre">replicaTable</span></code>, while at the same time it writes just the <code class="docutils literal"><span class="pre">userIds</span></code> to the <code class="docutils literal"><span class="pre">usersTable</span></code>
when a user&#8217;s purchase price is greater than 1000. This filtering logic is applied using an included script
<code class="docutils literal"><span class="pre">spendingUsersScript</span></code>:</p>
<a class="reference internal image-reference" href="../_images/forkInPipeline.png"><img alt="../_images/forkInPipeline.png" class="align-center" src="../_images/forkInPipeline.png" style="width: 6in;" /></a>
<div class="highlight container">
<pre class="literal-block">
{
  &quot;artifact&quot;: {
    &quot;name&quot;: &quot;cdap-etl-batch&quot;,
    &quot;version&quot;: &quot;3.4.3&quot;,
    &quot;scope&quot;: &quot;SYSTEM&quot;
  },
  &quot;config&quot;: {
    &quot;source&quot;: {
      &quot;name&quot;: &quot;purchaseStats&quot;,
      &quot;plugin&quot;: {
        &quot;name&quot;: &quot;Stream&quot;,
        &quot;properties&quot;: {
          &quot;format&quot;: &quot;csv&quot;,
          &quot;schema&quot;: &quot;{
            &quot;type&quot;:&quot;record&quot;,
            &quot;name&quot;:&quot;etlSchemaBody&quot;,
            &quot;fields&quot;:[
              {&quot;name&quot;:&quot;userId&quot;,&quot;type&quot;:&quot;string&quot;},
              {&quot;name&quot;:&quot;purchaseItem&quot;,&quot;type&quot;:&quot;string&quot;},
              {&quot;name&quot;:&quot;purchasePrice&quot;,&quot;type&quot;:&quot;long&quot;}
            ]
          }&quot;,
          &quot;name&quot;: &quot;testStream&quot;,
          &quot;duration&quot;: &quot;1d&quot;
        }
      }
    },
    &quot;sinks&quot;: [
      {
        &quot;name&quot;: &quot;replicaTable&quot;,
        &quot;plugin&quot;: {
          &quot;name&quot;: &quot;Table&quot;,
          &quot;properties&quot;: {
            &quot;schema&quot;: &quot;{
              &quot;type&quot;:&quot;record&quot;,
              &quot;name&quot;:&quot;etlSchemaBody&quot;,
              &quot;fields&quot;:[
                {&quot;name&quot;:&quot;userId&quot;,&quot;type&quot;:&quot;string&quot;},
                {&quot;name&quot;:&quot;purchaseItem&quot;,&quot;type&quot;:&quot;string&quot;},
                {&quot;name&quot;:&quot;purchasePrice&quot;,&quot;type&quot;:&quot;long&quot;}
              ]
            }&quot;,
            &quot;name&quot;: &quot;replicaTable&quot;,
            &quot;schema.row.field&quot;: &quot;userId&quot;
          }
        }
      },
      {
        &quot;name&quot;: &quot;usersTable&quot;,
        &quot;plugin&quot;: {
          &quot;name&quot;: &quot;Table&quot;,
          &quot;properties&quot;: {
            &quot;schema&quot;: &quot;{
              &quot;type&quot;:&quot;record&quot;,
              &quot;name&quot;:&quot;etlSchemaBody&quot;,
              &quot;fields&quot;:[
                {&quot;name&quot;:&quot;userId&quot;,&quot;type&quot;:&quot;string&quot;}
              ]
            }&quot;,
            &quot;name&quot;: &quot;targetCustomers&quot;,
            &quot;schema.row.field&quot;: &quot;userId&quot;
          }
        }
      }
    ],
    &quot;transforms&quot;: [
      {
        &quot;name&quot;: &quot;spendingUsersScript&quot;,
        &quot;plugin&quot;: {
          &quot;name&quot;: &quot;Script&quot;,
          &quot;properties&quot;: {
            &quot;script&quot;: &quot;function transform(input, context) {
                        if (input.purchasePrice &gt; 1000) {
                          return {'userId' : input.userId};
                        }
                      }&quot;,
            &quot;schema&quot;: &quot;{
              &quot;type&quot;:&quot;record&quot;,
              &quot;name&quot;:&quot;etlSchemaBody&quot;,
              &quot;fields&quot;:[
                {&quot;name&quot;:&quot;userId&quot;,&quot;type&quot;:&quot;string&quot;}
              ]
            }&quot;
          }
        }
      }
    ],
    &quot;connections&quot;: [
      {
        &quot;from&quot;: &quot;purchaseStats&quot;,
        &quot;to&quot;: &quot;replicaTable&quot;
      },
      {
        &quot;from&quot;: &quot;purchaseStats&quot;,
        &quot;to&quot;: &quot;spendingUsersScript&quot;
      },
      {
        &quot;from&quot;: &quot;spendingUsersScript&quot;,
        &quot;to&quot;: &quot;usersTable&quot;
      }
    ],
    &quot;schedule&quot;: &quot;* * * * *&quot;,
    &quot;engine&quot;: &quot;mapreduce&quot;
  }
}
</pre>
</div>
<p>Pipeline connections can be configured to fork from a stage, with the output of the stage sent to
two or more configured stages; in the above example,
the output record from <code class="docutils literal"><span class="pre">purchaseStats</span></code> will be sent to both <code class="docutils literal"><span class="pre">replicaTable</span></code> and <code class="docutils literal"><span class="pre">spendingUsersScript</span></code> stages.</p>
</div>
<div class="section" id="merging-stages-in-pipeline">
<h4>Merging Stages in Pipeline<a class="headerlink" href="#merging-stages-in-pipeline" title="Permalink to this headline">¶</a></h4>
<p>Forked transform stages can merge together at a transform or a sink stage.
A merge does not join, or modify records in any way. It simply means that multiple stages can write to the same stage.
The only requirement is that all stages must output records of the same schema to the merging stage. Note that
the order of records sent from the forked stages to the merging stage will not be defined.</p>
<p>In this next example, <code class="docutils literal"><span class="pre">purchaseStream</span></code> has purchase data with fields <code class="docutils literal"><span class="pre">userid</span></code>, <code class="docutils literal"><span class="pre">item</span></code>, <code class="docutils literal"><span class="pre">count</span></code>, and <code class="docutils literal"><span class="pre">price</span></code>.
The stream events source stage <code class="docutils literal"><span class="pre">purchaseStream</span></code> forks, and records are sent to both of the
transforms <code class="docutils literal"><span class="pre">userRewards</span></code> and <code class="docutils literal"><span class="pre">itemRewards</span></code>.</p>
<p>The <code class="docutils literal"><span class="pre">userRewards</span></code> transform script looks up valued customers in the table <code class="docutils literal"><span class="pre">hvCustomers</span></code>,
to check if <code class="docutils literal"><span class="pre">userid</span></code> is a valued customer and assigns higher rewards if they are.
After calculating the rewards, this transform sends an output record in the format <code class="docutils literal"><span class="pre">userid(string),</span> <span class="pre">rewards(double)</span></code>.</p>
<p>The <code class="docutils literal"><span class="pre">itemRewards</span></code> transform script awards higher rewards for bulk purchases and sends output records in the
same format, <code class="docutils literal"><span class="pre">userid(string),</span> <span class="pre">rewards(double)</span></code>.</p>
<p>The rewards records are merged at the sink <code class="docutils literal"><span class="pre">rewardsSink</span></code>; note that the incoming schema from the transforms
<code class="docutils literal"><span class="pre">userRewards</span></code> and <code class="docutils literal"><span class="pre">itemRewards</span></code> are the same, and that the order of received records will vary.</p>
<a class="reference internal image-reference" href="../_images/mergeInPipeline.png"><img alt="../_images/mergeInPipeline.png" class="align-center" src="../_images/mergeInPipeline.png" style="width: 8in;" /></a>
<div class="highlight container">
<pre class="literal-block">
{
  &quot;artifact&quot;: {
      &quot;name&quot;: &quot;cdap-etl-batch&quot;,
      &quot;version&quot;: &quot;3.4.3&quot;,
      &quot;scope&quot;: &quot;SYSTEM&quot;
  },
  &quot;name&quot;: &quot;RewardsPipeline&quot;,
  &quot;config&quot;: {
    &quot;source&quot;: {
      &quot;name&quot;: &quot;purchaseStream&quot;,
      &quot;plugin&quot;: {
        &quot;name&quot;: &quot;Stream&quot;,
        &quot;properties&quot;: {
          &quot;format&quot;: &quot;csv&quot;,
          &quot;schema&quot;: &quot;{
            &quot;type&quot;:&quot;record&quot;,
            &quot;name&quot;:&quot;etlSchemaBody&quot;,
            &quot;fields&quot;:[
              {&quot;name&quot;:&quot;userid&quot;,&quot;type&quot;:&quot;string&quot;},
              {&quot;name&quot;:&quot;item&quot;,&quot;type&quot;:&quot;string&quot;},
              {&quot;name&quot;:&quot;count&quot;,&quot;type&quot;:&quot;int&quot;},
              {&quot;name&quot;:&quot;price&quot;,&quot;type&quot;:&quot;long&quot;}
            ]
          }&quot;,
          &quot;name&quot;: &quot;purchases&quot;,
          &quot;duration&quot;: &quot;1d&quot;
        }
      }
    },
    &quot;sinks&quot;: [
      {
        &quot;name&quot;: &quot;rewardsSink&quot;,
        &quot;plugin&quot;: {
          &quot;name&quot;: &quot;TPFSAvro&quot;,
          &quot;properties&quot;: {
            &quot;schema&quot;: &quot;{
              &quot;type&quot;:&quot;record&quot;,
              &quot;name&quot;:&quot;etlSchemaBody&quot;,
              &quot;fields&quot;:[
                {&quot;name&quot;:&quot;userid&quot;,&quot;type&quot;:&quot;string&quot;},
                {&quot;name&quot;:&quot;rewards&quot;,&quot;type&quot;:&quot;double&quot;}
              ]
            }&quot;
          }
        }
      }
    ],
    &quot;transforms&quot;: [
      {
        &quot;name&quot;: &quot;userRewards&quot;,
        &quot;plugin&quot;: {
          &quot;name&quot;: &quot;Script&quot;,
          &quot;properties&quot;: {
            &quot;script&quot;: &quot;function transform(input, context) {
              var rewards = 5;
              if (context.getLookup('hvCustomers').lookup(input.userid) !== null) {
                context.getLogger().info(&quot;user &quot; + input.userid + &quot; is a valued customer&quot;);
                rewards = 100;
              } else {
                context.getLogger().info(&quot;user &quot; + input.userid + &quot; is not a valued customer&quot;);
              }
              return {'userid': input.userid, 'rewards': rewards};
            }&quot;,
            &quot;schema&quot;: &quot;{
              &quot;type&quot;:&quot;record&quot;,
              &quot;name&quot;:&quot;etlSchemaBody&quot;,
              &quot;fields&quot;:[
                {&quot;name&quot;:&quot;userid&quot;,&quot;type&quot;:&quot;string&quot;},
                {&quot;name&quot;:&quot;rewards&quot;,&quot;type&quot;:&quot;double&quot;}
              ]
            }&quot;,
            &quot;lookup&quot;: &quot;{&quot;tables&quot;:{&quot;hvCustomers&quot;:{&quot;type&quot;:&quot;DATASET&quot;,&quot;datasetProperties&quot;:{}}}}&quot;
          }
        }
      },
      {
        &quot;name&quot;: &quot;itemRewards&quot;,
        &quot;plugin&quot;: {
          &quot;name&quot;: &quot;Script&quot;,
          &quot;properties&quot;: {
            &quot;script&quot;: &quot;function transform(input, context) {
              var rewards = 5;
              if (input.count &gt; 20) {
                rewards = 50;
              }
              return {'userid':input.userid, 'rewards':rewards};
            }&quot;,
            &quot;schema&quot;: &quot;{
              &quot;type&quot;:&quot;record&quot;,
              &quot;name&quot;:&quot;etlSchemaBody&quot;,
              &quot;fields&quot;:[
                {&quot;name&quot;:&quot;userid&quot;,&quot;type&quot;:&quot;string&quot;},
                {&quot;name&quot;:&quot;rewards&quot;,&quot;type&quot;:&quot;double&quot;}
              ]
            }&quot;
          }
        }
      }
    ],
    &quot;connections&quot;: [
      {
        &quot;from&quot;: &quot;purchaseStream&quot;,
        &quot;to&quot;: &quot;userRewards&quot;
      },
      {
        &quot;from&quot;: &quot;userRewards&quot;,
        &quot;to&quot;: &quot;rewardsSink&quot;
      },
      {
        &quot;from&quot;: &quot;purchaseStream&quot;,
        &quot;to&quot;: &quot;itemRewards&quot;
      },
      {
        &quot;from&quot;: &quot;itemRewards&quot;,
        &quot;to&quot;: &quot;rewardsSink&quot;
      }
    ],
    &quot;comments&quot;: [],
    &quot;schedule&quot;: &quot;* * * * *&quot;,
    &quot;engine&quot;: &quot;mapreduce&quot;
  }
}
</pre>
</div>
</div>
</div>
<div class="section" id="sample-application-configurations">
<h3>Sample Application Configurations<a class="headerlink" href="#sample-application-configurations" title="Permalink to this headline">¶</a></h3>
<p><strong>Database:</strong> Sample config for using a Database Source and a Database Sink:</p>
<div class="highlight container">
<pre class="literal-block">
{
  &quot;artifact&quot;: {
    &quot;name&quot;: &quot;cdap-etl-batch&quot;,
    &quot;version&quot;: &quot;3.4.3&quot;,
    &quot;scope&quot;: &quot;system&quot;
  },
  &quot;config&quot;: {
    &quot;schedule&quot;: &quot;* * * * *&quot;,
    &quot;source&quot;: {
      &quot;name&quot;: &quot;databaseSource&quot;,
      &quot;plugin&quot;: {
        &quot;name&quot;: &quot;Database&quot;,
        &quot;properties&quot;: {
          &quot;importQuery&quot;: &quot;select id,name,age from my_table&quot;,
          &quot;countQuery&quot;: &quot;select count(id) from my_table&quot;,
          &quot;connectionString&quot;: &quot;jdbc:mysql://localhost:3306/test&quot;,
          &quot;tableName&quot;: &quot;src_table&quot;,
          &quot;user&quot;: &quot;my_user&quot;,
          &quot;password&quot;: &quot;my_password&quot;,
          &quot;jdbcPluginName&quot;: &quot;jdbc_plugin_name_defined_in_jdbc_plugin_json_config&quot;,
          &quot;jdbcPluginType&quot;: &quot;jdbc_plugin_type_defined_in_jdbc_plugin_json_config&quot;
        }
      }
    },
    &quot;sinks&quot;: [
      {
        &quot;name&quot;: &quot;databaseSink&quot;,
        &quot;plugin&quot;: {
          &quot;name&quot;: &quot;Database&quot;,
          &quot;properties&quot;: {
            &quot;columns&quot;: &quot;id,name,age&quot;,
            &quot;connectionString&quot;: &quot;jdbc:mysql://localhost:3306/test&quot;,
            &quot;tableName&quot;: &quot;dest_table&quot;,
            &quot;user&quot;: &quot;my_user&quot;,
            &quot;password&quot;: &quot;my_password&quot;,
            &quot;jdbcPluginName&quot;: &quot;jdbc_plugin_name_defined_in_jdbc_plugin_json_config&quot;,
            &quot;jdbcPluginType&quot;: &quot;jdbc_plugin_type_defined_in_jdbc_plugin_json_config&quot;
          }
        }
      }
    ],
    &quot;transforms&quot;: [ ],
    &quot;connections&quot;: [
      {
        &quot;from&quot;: &quot;databaseSource&quot;,
        &quot;to&quot;: &quot;databaseSink&quot;
      }
    ]
  }
}
</pre>
</div>
<p><strong>Kafka:</strong> A Kafka cluster needs to be setup, and certain minimum properties specified when
creating the source:</p>
<div class="highlight container">
<pre class="literal-block">
{
  &quot;artifact&quot;: {
    &quot;name&quot;: &quot;cdap-etl-realtime&quot;,
    &quot;version&quot;: &quot;3.4.3&quot;,
    &quot;scope&quot;: &quot;system&quot;
  },
  &quot;config&quot;: {
    &quot;instances&quot;: 1,
    &quot;source&quot;: {
      &quot;name&quot;: &quot;kafkaSource&quot;,
      &quot;plugin&quot;: {
        &quot;name&quot;: &quot;Kafka&quot;,
        &quot;properties&quot;: {
          &quot;kafka.partitions&quot;: &quot;1&quot;,
          &quot;kafka.topic&quot;: &quot;test&quot;,
          &quot;kafka.brokers&quot;: &quot;localhost:9092&quot;
        }
      }
    },
    &quot;sinks&quot;: [
      {
        &quot;name&quot;: &quot;streamSink&quot;,
        &quot;plugin&quot;: {
          &quot;name&quot;: &quot;Stream&quot;,
          &quot;properties&quot;: {
            &quot;name&quot;: &quot;myStream&quot;,
            &quot;body.field&quot;: &quot;message&quot;
          }
        }
      }
    ],
    &quot;transforms&quot;: [ ],
    &quot;connections&quot;: [
      {
        &quot;from&quot;: &quot;kafkaSource&quot;,
        &quot;to&quot;: &quot;streamSink&quot;
      }
    ]
  }
}
</pre>
</div>
<p><strong>Prebuilt JARs:</strong> In a case where you&#8217;d like to use prebuilt third-party JARs (such as a
JDBC driver) as a plugin, please refer to the section on <a class="reference internal" href="hydrator-plugins/third-party.html#cdap-apps-third-party-jars"><span>Using Third-Party Jars</span></a>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
    
    
    
    
    
    
    
    
    
    
    
    
  <div role="note" aria-label="manuals links">
    <h3><a href="../table-of-contents/../../index.html" rel="nofollow">CDAP Documentation v3.4.3</a></h3>
    <ul class="this-page-menu">
      <li><div class=""></div><a href="../table-of-contents/../../index.html" rel="nofollow">Overview</a></li>
      <li><div class=""></div><a href="../table-of-contents/../../introduction/index.html" rel="nofollow">Introduction to CDAP</a></li>
      <li><div class=""></div><a href="../table-of-contents/../../developers-manual/index.html" rel="nofollow">Developers’ Manual</a></li>
      <li><div class=""></div><a href="../table-of-contents/../../cdap-apps/index.html" rel="nofollow">CDAP Applications</a></li>
      <li><div class=""></div><a href="../table-of-contents/../../admin-manual/index.html" rel="nofollow">Administration Manual</a></li>
      <li><div class=""></div><a href="../table-of-contents/../../integrations/index.html" rel="nofollow">Integrations</a></li>
      <li><div class=""></div><a href="../table-of-contents/../../examples-manual/index.html" rel="nofollow">Examples, Guides, and Tutorials</a></li>
      <li><div class=""></div><a href="../table-of-contents/../../reference-manual/index.html" rel="nofollow">Reference Manual</a></li>
      <li><div class=""></div><a href="../table-of-contents/../../faqs/index.html" rel="nofollow">FAQs</a></li>
      <li><div class=""></div><a href="../table-of-contents/../../reference-manual/release-notes.html" rel="nofollow">Release Notes</a></li>
      <li><div class=""></div><a href="../table-of-contents/../../reference-manual/glossary.html" rel="nofollow">Glossary</a></li>
      <li><div class=""></div><a href="../table-of-contents/../../search.html" rel="nofollow">Search</a></li>
    </ul>
  </div><!--
  Copyright © 2014-2015 Cask Data, Inc.

  Licensed under the Apache License, Version 2.0 (the "License"); you may not
  use this file except in compliance with the License. You may obtain a copy of
  the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
  License for the specific language governing permissions and limitations under
  the License.
-->


    
  <h3 class="pagenavtitle"><a href="../table-of-contents.html">CDAP Applications: Table&nbsp;of&nbsp;Contents</a></h3>
    <nav class="pagenav">
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html"> Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html"> Cask Hydrator and ETL</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html"> Overview</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href=""> Creating an ETL Application</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration-file-format">Configuration File Format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-an-etl-batch-application">Creating an ETL Batch Application</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-an-etl-real-time-application">Creating an ETL Real-Time Application</a></li>
<li class="toctree-l4"><a class="reference internal" href="#non-linear-executions-in-pipelines">Non-linear Executions in Pipelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sample-application-configurations">Sample Application Configurations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="custom.html"> Creating Custom ETL Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="hydrator-plugins/index.html"> ETL Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade.html"> Upgrading ETL Applications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tracker/index.html"> Cask Tracker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-quality/index.html"> Data Quality Application</a></li>
</ul>
 
    </nav>
  <h4>Topics</h4>
  <ul>
  <li class="topless"><i>Previous:</i> <a href="upgrade.html"
                        title="Previous Topic">ETL Upgrade Procedure</a></li>
  <li class="topless"><i>Next:</i> <a href="custom.html"
                        title="Next Topic">Creating Custom ETL Plugins</a></li>
  </ul>
  <div role="note" aria-label="downloads links">
    <h3>Downloads</h3>
    <ul class="this-page-menu">
      <li><a href="http://docs.cask.co/cdap/3.4.3/cdap-docs-3.4.3-web.zip"
            rel="nofollow">Zip Archive of CDAP Documentation</a></li>
    </ul>
   </div>
  
<div id="searchbox" style="display: none" role="search">
  <h3>Quick Search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<div role="note" aria-label="other links">
    <h3><a href="http://docs.cask.co/" target="_blank">Documentation</a></h3>
    <ul class="this-page-menu">
        <li><a href="http://docs.cask.co/cdap/index.html" target="_blank">CDAP</a></li>
        <li><a href="http://docs.cask.co/coopr/index.html" target="_blank">Coopr</a></li>
        <li><a href="http://docs.cask.co/tephra/index.html" target="_blank">Tephra</em></a></li>
        <li><a href="http://docs.cask.co/tigon/index.html" target="_blank">Tigon</a></li>
    </ul>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;margin:0px auto;}
.tg td{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg th{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg .tg-s6z2{text-align:center;}
.tg .tg-0ord{text-align:right;}
.tg a{font-weight:bold;}
</style>
<table class="tg" width= 100%>
  <tr>
    <th class="tg-031e">Previous Topic: 
    <a title="ETL Upgrade Procedure" href="upgrade.html" />ETL Upgrade Procedure</a>&nbsp;&nbsp;
    
    </th>
    <th class="tg-s6z2">
        Copyright &copy; 2014-2016 Cask Data, Inc.
    
    </th>
    <th class="tg-0ord">&nbsp;&nbsp;Next Topic:
    <a title="Creating Custom ETL Plugins" href="custom.html" />Creating Custom ETL Plugins</a>
    
    </th>
  </tr>
</table>

    </div>
  </body>
</html>