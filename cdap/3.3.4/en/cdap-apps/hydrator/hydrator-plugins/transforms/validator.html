<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="robots" content="noindex, nofollow">

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    
    
    <meta name="git_release" content="3.3.4">
    <meta name="git_hash" content="7ba74d9abb24b5ced30f51829eea8989b5de08af">
    <meta name="git_timestamp" content="2016-05-18 10:28:18 -0700">
    <title>Validator Transform &mdash; Cask Data Application Platform 3.3.4 Documentation</title>
    
    <link rel="stylesheet" href="../../../_static/cdap.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />



    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '3.3.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    
    <!-- Google Tag Manager start -->
    <script>dataLayer = [];</script>
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PBZ3JL"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PBZ3JL');</script>
    <!-- Google Tag Manager end -->
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Cask Data Application Platform 3.3.4 Documentation" href="../../../index.html" />
    <link rel="up" title="Transformations" href="index.html" />
    <link rel="next" title="Batch Sinks" href="../batchsinks/index.html" />
    <link rel="prev" title="StructuredRecord To GenericRecord Transform" href="structuredrecordtogenericrecord.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="../batchsinks/index.html" title="Batch Sinks"
             accesskey="N">Next</a> |</li>
        <li class="right" >
          <a href="structuredrecordtogenericrecord.html" title="StructuredRecord To GenericRecord Transform"
             accesskey="P">Previous</a> |</li>
        
        <script type="text/javascript" src="../../../_static/version-menu.js"></script>
        <script src="http://docs.cask.co/cdap/json-versions.js"/></script>
        <script>window.setVersion('3.3.4');</script>
       
        <li><a href="../../../table-of-contents.html">CDAP CDAP Applications</a> &raquo;</li>
          <li><a href="../../index.html" >Cask Hydrator and ETL Pipelines</a> &raquo;</li>
          <li><a href="../index.html" >ETL Plugins</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Transformations</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="validator-transform">
<span id="validator-transform"></span><h1>Validator Transform<a class="headerlink" href="#validator-transform" title="Permalink to this headline">¶</a></h1>
<div class="section" id="description">
<span id="description"></span><h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Validates a record, writing to an error dataset if the record is invalid.
Otherwise it passes the record on to the next stage.</p>
<p>This table lists the methods available in CoreValidator that can be called from the ValidatorTransform:</p>
<pre class="literal-block">
+==================================================================================================================+
| function                                        | description                                                    |
+==================================================================================================================+
| isDate(String date)                             | Returns true if the passed param is a valid date               |
| isCreditCard(String card)                       | Returns true if the passed param is a valid CreditCard         |
| isBlankOrNull(String val)                       | Checks if the field is null and length of the field is greater |
|                                                 | than zero not including whitespace                             |
| isEmail(String email)                           | Checks if a field has a valid e-mail address                   |
| isInRange(double value, double min, double max) | Checks if a value is within a range                            |
| isInRange(int value, int min, int max)          | Checks if a value is within a range                            |
| isInRange(float value, float min, float max)    | Checks if a value is within a range                            |
| isInRange(short value, short min, short max)    | Checks if a value is within a range                            |
| isInRange(long value, long min, long max)       | Checks if a value is within a range                            |
| isInt(String input)                             | Checks if the value can be converted to a int primitive        |
| isLong(String input)                            | Checks if the value can be converted to a long primitive       |
| isShort(String input)                           | Checks if the value can be converted to a short primitive      |
| isUrl(String input)                             | Checks if the value can be converted to a int primitive        |
| matchRegex(String pattern, String input)        | Checks if the value matches the regular expression             |
| maxLength(String input, int maxLength)          | Checks if the value length is less than or equal to the max    |
| maxValue(double val, double maxVal)             | Checks if the value is less than or equal to the max           |
| maxValue(long val, long maxVal)                 | Checks if the value is less than or equal to the max           |
| maxValue(int val, int maxVal)                   | Checks if the value is less than or equal to the max           |
| maxValue(float val, float maxVal)               | Checks if the value is less than or equal to the max           |
| minValue(double val, double minVal)             | Checks if the value is greater than or equal to the min        |
| minValue(long val, long minVal)                 | Checks if the value is greater than or equal to the min        |
| minValue(int val, int minVal)                   | Checks if the value is greater than or equal to the min        |
| minValue(float val, float minVal)               | Checks if the value is greater than or equal to the min        |
| minLength(String input, int length)             | Checks if the value length is greater than or equal to the min |
| isValidISBN(String isbn)                        | Checks if the code is either a valid ISBN-10 or ISBN-13 code   |
| isValidInet4Address(String ipv4)                | Validates an IPv4 address                                      |
| isValidInet6Address(String ipv6)                | Validates an IPv6 address                                      |
| isValidIp(String ip)                            | Checks if the specified string is a valid IP address           |
| isValidCountryCodeTid(String ccTld)             | Returns true if the input matches any IANA-defined             |
|                                                 | country code top-level domain                                  |
| isValidGenericTId(String gTld)                  | Returns true if the input matches any IANA-defined             |
|                                                 | generic top-level domain                                       |
| isValidInfrastructureTId(String iTld)           | Returns true if the input matches any IANA-defined             |
|                                                 | infrastructure top-level domain                                |
| isValidLocalTId(String lTld)                    | Returns true if the input matches any widely used              |
|                                                 | local domains (localhost or localdomain)                       |
| isValidTId(String tld)                          | Returns true if the input matches any IANA-defined             |
|                                                 | top-level domain                                               |
+==================================================================================================================+
</pre>
</div>
<div class="section" id="use-case">
<span id="use-case"></span><h2>Use Case<a class="headerlink" href="#use-case" title="Permalink to this headline">¶</a></h2>
<p>The transform is used when you need to validate records. For example, you may want to
validate records as being valid IP addresses or valid dates and log errors if they aren&#8217;t
valid.</p>
</div>
<div class="section" id="properties">
<span id="properties"></span><h2>Properties<a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<p><strong>validators</strong> Comma-separated list of validators that are used by the validationScript.
Example: <code class="docutils literal"><span class="pre">&quot;validators&quot;:</span> <span class="pre">&quot;core&quot;</span></code></p>
<p><strong>validationScript:</strong> Javascript that must implement a function <code class="docutils literal"><span class="pre">isValid</span></code> that takes a JSON object
(representing the input record) and a context object (encapsulating CDAP metrics, logger, and validators)
and returns a result JSON with validity, error code, and error message.
Example response:</p>
<pre class="literal-block">
{
    &quot;isValid&quot; : true [or] false,
    &quot;errorCode&quot; : number [should be an valid integer],
    &quot;errorMsg&quot; : &quot;Message indicating the error and why the record failed validation&quot;
}
</pre>
<p><strong>lookup:</strong> The configuration of the lookup tables to be used in your script.
For example, if lookup table &#8220;purchases&#8221; is configured, then you will be able to perform
operations with that lookup table in your script: <code class="docutils literal"><span class="pre">context.getLookup('purchases').lookup('key')</span></code>
Currently supports <code class="docutils literal"><span class="pre">KeyValueTable</span></code>.</p>
</div>
<div class="section" id="examples">
<span id="examples"></span><h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>This example sends an error code <code class="docutils literal"><span class="pre">'10'</span></code> for any records whose <code class="docutils literal"><span class="pre">'body'</span></code> field contains
a value whose length is greater than 10. It has been &#8220;pretty-printed&#8221; for readability. It
uses the <code class="docutils literal"><span class="pre">CoreValidator</span></code> (included using <code class="docutils literal"><span class="pre">&quot;validators&quot;:</span> <span class="pre">&quot;core&quot;</span></code> ) and references a
function using its Javascript name (<code class="docutils literal"><span class="pre">coreValidator.maxLength</span></code>):</p>
<pre class="literal-block">
  {
    &quot;name&quot;: &quot;Validator&quot;,
    &quot;properties&quot;: {
      &quot;validators&quot;: &quot;core&quot;,
      &quot;validationScript&quot;: &quot;function isValid(input, context) {
                              var coreValidator = context.getValidator(\&quot;coreValidator\&quot;);
                              if (!coreValidator.maxLength(input.body, 10))
                                {
                                  return {'isValid': false, 'errorCode': 10,
                                          'errorMsg': \&quot;body length greater than 10\&quot;};
                                }
                              return {'isValid' : true};
                            };&quot;
    }
  }
</pre>
<p>This example uses the key-value dataset <code class="docutils literal"><span class="pre">'blacklist'</span></code> as a lookup table, and sends an
error code <code class="docutils literal"><span class="pre">'10'</span></code> for any records whose <code class="docutils literal"><span class="pre">'body'</span></code> field exists in the <code class="docutils literal"><span class="pre">'blacklist'</span></code>
dataset. It has been &#8220;pretty-printed&#8221; for readability:</p>
<pre class="literal-block">
{
    &quot;name&quot;: &quot;Validator&quot;,
    &quot;properties&quot;: {
        &quot;lookup&quot;: &quot;{
            \&quot;blacklist\&quot;:{
                \&quot;type\&quot;:\&quot;DATASET\&quot;
            }
        }&quot;
        &quot;validationScript&quot;: &quot;function isValid(input, context) {
                              if (context.getLookup('blacklist').lookup(input.body) !== null)
                                {
                                  return {'isValid': false, 'errorCode': 10,
                                          'errorMsg': \&quot;input blacklisted\&quot;};
                                }
                              return {'isValid' : true};
                            };&quot;
    }
}
</pre>
<p>This example sends an error code <code class="docutils literal"><span class="pre">'5'</span></code> for any records whose <code class="docutils literal"><span class="pre">'date'</span></code> field is an
invalid date, sends an error code <code class="docutils literal"><span class="pre">'7'</span></code> for any records whose <code class="docutils literal"><span class="pre">'url'</span></code> field is an
invalid URL, and sends an error code <code class="docutils literal"><span class="pre">'10'</span></code> for any records whose <code class="docutils literal"><span class="pre">'content_length'</span></code>
field is greater than 1MB.</p>
<p>It has been &#8220;pretty-printed&#8221; for readability. It uses the CoreValidator and references functions
using their Javascript names (such as <code class="docutils literal"><span class="pre">coreValidator.isDate</span></code>):</p>
<pre class="literal-block">
{
    &quot;name&quot;: &quot;Validator&quot;,
    &quot;properties&quot;: {
        &quot;validators&quot;: &quot;core&quot;,
        &quot;validationScript&quot;: &quot;function isValid(input, context) {
                              var isValid = true;
                              var errMsg = \&quot;\&quot;;
                              var errCode = 0;
                              var coreValidator = context.getValidator(\&quot;coreValidator\&quot;);
                              var metrics = context.getMetrics();
                              var logger = context.getLogger();
                              if (!coreValidator.isDate(input.date)) {
                                 isValid = false; errMsg = input.date + \&quot;is invalid date\&quot;; errCode = 5;
                                 metrics.count(\&quot;invalid.date\&quot;, 1);
                              } else if (!coreValidator.isUrl(input.url)) {
                                 isValid = false; errMsg = \&quot;invalid url\&quot;; errCode = 7;
                                 metrics.count(\&quot;invalid.url\&quot;, 1);
                              } else if (!coreValidator.isInRange(input.content_length, 0, 1024 * 1024)) {
                                 isValid = false; errMsg = \&quot;content length &gt;1MB\&quot;; errCode = 10;
                                 metrics.count(\&quot;invalid.body.size\&quot;, 1);
                              }
                              if (!isValid) {
                                logger.warn(\&quot;Validation failed for record {}\&quot;, input);
                              }
                              return {'isValid': isValid, 'errorCode': errCode, 'errorMsg': errMsg};
                            };&quot;
    }
}
</pre>
<p><strong>Note:</strong> This plugin emits a metric called &#8216;invalid&#8217; that tracks how many invalid records were found.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
    
    
    
    
    
    
    
    
    
    
    
    
  <div role="note" aria-label="manuals links">
    <h3><a href="../../../table-of-contents/../../index.html" rel="nofollow">CDAP Documentation v3.3.4</a></h3>
    <ul class="this-page-menu">
      <li><div class=""></div><a href="../../../table-of-contents/../../index.html" rel="nofollow">Overview</a></li>
      <li><div class=""></div><a href="../../../table-of-contents/../../introduction/index.html" rel="nofollow">Introduction to CDAP</a></li>
      <li><div class=""></div><a href="../../../table-of-contents/../../developers-manual/index.html" rel="nofollow">Developers’ Manual</a></li>
      <li><div class=""></div><a href="../../../table-of-contents/../../cdap-apps/index.html" rel="nofollow">CDAP Applications</a></li>
      <li><div class=""></div><a href="../../../table-of-contents/../../admin-manual/index.html" rel="nofollow">Administration Manual</a></li>
      <li><div class=""></div><a href="../../../table-of-contents/../../integrations/index.html" rel="nofollow">Integrations</a></li>
      <li><div class=""></div><a href="../../../table-of-contents/../../examples-manual/index.html" rel="nofollow">Examples, Guides, and Tutorials</a></li>
      <li><div class=""></div><a href="../../../table-of-contents/../../reference-manual/index.html" rel="nofollow">Reference Manual</a></li>
      <li><div class=""></div><a href="../../../table-of-contents/../../faqs/index.html" rel="nofollow">FAQs</a></li>
      <li><div class=""></div><a href="../../../table-of-contents/../../reference-manual/release-notes.html" rel="nofollow">Release Notes</a></li>
      <li><div class=""></div><a href="../../../table-of-contents/../../reference-manual/glossary.html" rel="nofollow">Glossary</a></li>
      <li><div class=""></div><a href="../../../table-of-contents/../../search.html" rel="nofollow">Search</a></li>
    </ul>
  </div><!--
  Copyright © 2014-2015 Cask Data, Inc.

  Licensed under the Apache License, Version 2.0 (the "License"); you may not
  use this file except in compliance with the License. You may obtain a copy of
  the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
  License for the specific language governing permissions and limitations under
  the License.
-->


    
  <h3 class="pagenavtitle"><a href="../../../table-of-contents.html">CDAP Applications: Table&nbsp;of&nbsp;Contents</a></h3>
    <nav class="pagenav">
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html"> Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html"> Cask Hydrator and ETL</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../overview.html"> Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../creating.html"> Creating an ETL Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../custom.html"> Creating Custom ETL Plugins</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html"> ETL Plugins</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../batchsources/index.html"> Batch Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../realtimesources/index.html"> Real-time Sources</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html"> Transformations</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="clonerecord.html">Clone Record Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="compressor.html">Compressor Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="csvformatter.html">CSV Formatter Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="csvparser.html">CSV Parser Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="decoder.html">Decoder Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="decompressor.html">Decompressor Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="encoder.html">Encoder Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="hasher.html">Hasher Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html">JavaScript Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonformatter.html">JSON Formatter Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonparser.html">JSON Parser Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="logparser.html">Log Parser Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="projection.html">Projection Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="pythonevaluator.html">Python Evaluator Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="script.html">Script Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="scriptfilter.html">Script Filter Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="streamformatter.html">Stream Formatter Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="structuredrecordtogenericrecord.html">StructuredRecord To GenericRecord Transform</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="">Validator Transform</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../batchsinks/index.html"> Batch Sinks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../realtimesinks/index.html"> Real-time Sinks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shared-plugins/index.html"> Shared Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../third-party.html"> Third-Party Jars</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../upgrade.html"> Upgrading ETL Applications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../data-quality/index.html"> Data Quality Application</a></li>
</ul>
 
    </nav>
  <h4>Topics</h4>
  <ul>
  <li class="topless"><i>Previous:</i> <a href="structuredrecordtogenericrecord.html"
                        title="Previous Topic">StructuredRecord To GenericRecord Transform</a></li>
  <li class="topless"><i>Next:</i> <a href="../batchsinks/index.html"
                        title="Next Topic">Batch Sinks</a></li>
  </ul>
  <div role="note" aria-label="downloads links">
    <h3>Downloads</h3>
    <ul class="this-page-menu">
      <li><a href="http://docs.cask.co/cdap/3.3.4/cdap-docs-3.3.4-web.zip"
            rel="nofollow">Zip Archive of CDAP Documentation</a></li>
    </ul>
   </div>
  
<div id="searchbox" style="display: none" role="search">
  <h3>Quick Search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<div role="note" aria-label="other links">
    <h3><a href="http://docs.cask.co/" target="_blank">Documentation</a></h3>
    <ul class="this-page-menu">
        <li><a href="http://docs.cask.co/cdap/index.html" target="_blank">CDAP</a></li>
        <li><a href="http://docs.cask.co/coopr/index.html" target="_blank">Coopr</a></li>
        <li><a href="http://docs.cask.co/tephra/index.html" target="_blank">Tephra</em></a></li>
        <li><a href="http://docs.cask.co/tigon/index.html" target="_blank">Tigon</a></li>
    </ul>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;margin:0px auto;}
.tg td{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg th{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg .tg-s6z2{text-align:center;}
.tg .tg-0ord{text-align:right;}
.tg a{font-weight:bold;}
</style>
<table class="tg" width= 100%>
  <tr>
    <th class="tg-031e">Previous Topic: 
    <a title="StructuredRecord To GenericRecord Transform" href="structuredrecordtogenericrecord.html" />StructuredRecord To GenericRecord Transform</a>&nbsp;&nbsp;
    
    </th>
    <th class="tg-s6z2">
        Copyright &copy; 2014-2016 Cask Data, Inc.
    
    </th>
    <th class="tg-0ord">&nbsp;&nbsp;Next Topic:
    <a title="Batch Sinks" href="../batchsinks/index.html" />Batch Sinks</a>
    
    </th>
  </tr>
</table>

    </div>
  </body>
</html>