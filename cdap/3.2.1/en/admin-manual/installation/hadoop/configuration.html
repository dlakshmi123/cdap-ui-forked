<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="robots" content="noindex, nofollow">

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Cask Data, Inc." name="author" />
<meta content="Copyright © 2015 Cask Data, Inc." name="copyright" />
<script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-55081520-2']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    
    <meta name="git_release" content="3.2.1">
    <meta name="git_hash" content="c29c9673c53a5d392164c3a10dd414e28befd81e">
    <meta name="git_timestamp" content="2015-11-30 17:55:49 -0800">
    <title>Hadoop: Configuration &mdash; Cask Data Application Platform 3.2.1 Documentation</title>
    
    <link rel="stylesheet" href="../../_static/cdap.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    



    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '3.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    
    <!-- Amazon SQS Page Usage Logging start-->
    <script type="text/javascript" src="https://sdk.amazonaws.com/js/aws-sdk-2.1.35.min.js"></script>
    <script type="text/javascript" src="http://docs.cask.co/resources/scripts/aws-sqs-1.0.0.js"></script>
    <!-- Amazon SQS Page Usage Logging end-->
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Cask Data Application Platform 3.2.1 Documentation" href="../../index.html" />
    <link rel="up" title="Hadoop" href="index.html" />
    <link rel="next" title="Hadoop: From Starting Services to Verification" href="starting-verification.html" />
    <link rel="prev" title="Hadoop: Installation" href="installation.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="starting-verification.html" title="Hadoop: From Starting Services to Verification"
             accesskey="N">Next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Hadoop: Installation"
             accesskey="P">Previous</a> |</li>
        
        <script type="text/javascript" src="../../_static/version-menu.js"></script>
        <script src="http://docs.cask.co/cdap/json-versions.js"/></script>
        <script>window.setVersion('3.2.1');</script>
       
        <li><a href="../../table-of-contents.html">CDAP Administration Manual</a> &raquo;</li>
          <li><a href="../index.html" >Installation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Hadoop</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="hadoop-distribution-configuration">
<span id="hadoop-configuration"></span><h1>Hadoop: Configuration<a class="headerlink" href="#hadoop-distribution-configuration" title="Permalink to this headline">¶</a></h1>
<p>This page is to help you configure Cask Data Application Platform (CDAP). It provides the
instructions for <a class="reference external" href="#configuration">configuring</a> the CDAP components so they work with
your existing Hadoop cluster.</p>
<p>It&#8217;s assumed that you have already followed the <a class="reference external" href="installation.html">installation</a> steps.</p>
<p>After completing the configuration, you can <a class="reference external" href="starting-verification.html">start and verify</a> your installation.</p>
<div class="section" id="configuration">
<span id="hadoop-configuration-central"></span><h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">CDAP packages utilize a central configuration, stored by default in <code class="docutils literal"><span class="pre">/etc/cdap</span></code>.</p>
<p>When you install the CDAP base package, a default configuration is placed in
<code class="docutils literal"><span class="pre">/etc/cdap/conf.dist</span></code>. The <code class="docutils literal"><span class="pre">cdap-site.xml</span></code> file is a placeholder
where you can define your specific configuration for all CDAP components.
The <code class="docutils literal"><span class="pre">cdap-site.xml.example</span></code> file shows the properties that usually require customization
for all installations.</p>
<p id="hadoop-configuration-alternatives">Similar to Hadoop, CDAP utilizes the <code class="docutils literal"><span class="pre">alternatives</span></code> framework to allow you to
easily switch between multiple configurations. The <code class="docutils literal"><span class="pre">alternatives</span></code> system is used for ease of
management and allows you to to choose between different directories to fulfill the
same purpose.</p>
<p>Simply copy the contents of <code class="docutils literal"><span class="pre">/etc/cdap/conf.dist</span></code> into a directory of your choice
(such as <code class="docutils literal"><span class="pre">/etc/cdap/conf.mycdap</span></code>) and make all of your customizations there.
Then run the <code class="docutils literal"><span class="pre">alternatives</span></code> command to point the <code class="docutils literal"><span class="pre">/etc/cdap/conf</span></code> symlink
to your custom directory.</p>
</li>
<li id="hadoop-configuration-options"><p class="first">Configure the <code class="docutils literal"><span class="pre">cdap-site.xml</span></code> after you have installed the CDAP packages.</p>
<p>To configure your particular installation, modify <code class="docutils literal"><span class="pre">cdap-site.xml</span></code>, using
<code class="docutils literal"><span class="pre">cdap-site.example</span></code> as a model to follow. To make alterations to your configuration,
create (or edit if existing) an <cite>.xml</cite> file <code class="docutils literal"><span class="pre">conf/cdap-site.xml</span></code> (see the
<a class="reference internal" href="../../appendices/cdap-site.html#appendix-cdap-site-xml"><span>Appendix: cdap-default.xml and cdap-site.xml</span></a>) and set appropriate properties.</p>
<p>These properties are the minimal required configuration for the <code class="docutils literal"><span class="pre">cdap-site.xml</span></code> file:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;configuration&gt;</span>

  <span class="c">&lt;!-- General Configuration --&gt;</span>

  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>hdfs.namespace<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>/${root.namespace}<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>
      Root directory for HDFS files written by CDAP
    <span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>
  
  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>hdfs.user<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>yarn<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>
      User name for accessing HDFS
    <span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>

  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>root.namespace<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>cdap<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>
      Root for this CDAP instance; used as the parent (or root) node for
      ZooKeeper, as the directory under which all CDAP data and metadata is
      stored in HDFS, and as the prefix for all HBase tables created by
      CDAP; must be composed of alphanumeric characters
    <span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>

  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>zookeeper.quorum<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>FQDN1:2181,FQDN2:2181/${root.namespace}<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>
      ZooKeeper quorum string; specifies the ZooKeeper host:port; 
      substitute the quorum for the components shown here (FQDN1:2181,FQDN2:2181)
    <span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>


  <span class="c">&lt;!-- Router Configuration --&gt;</span>

  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>router.bind.address<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>0.0.0.0<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>
      Router server address
    <span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>
  
  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>router.bind.port<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>10000<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>
      Port number that the CDAP router should bind to for HTTP connections
    <span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>

  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>router.server.address<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>{ROUTER-HOST-IP}<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>
      Router address to which CDAP UI connects
    <span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>

  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>router.server.port<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>${router.bind.port}<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>
      Router port to which CDAP UI connects
    <span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>


  <span class="c">&lt;!-- Applications Configuration --&gt;</span>

  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>app.bind.address<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>0.0.0.0<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>
      Host address on which the app fabric server is started
    <span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>


  <span class="c">&lt;!-- Datasets Configuration --&gt;</span>

  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>data.tx.bind.address<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>0.0.0.0<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>
      Transaction service inet address
    <span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>


  <span class="c">&lt;!-- Kafka Server Configuration --&gt;</span>

  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>kafka.default.replication.factor<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>1<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>
      Kafka replication factor; used to replicate Kafka messages across
      multiple machines to prevent data loss in the event of a hardware
      failure. The recommended setting is to run at least two Kafka servers.
      If you are running two Kafka servers, set this value to 2; otherwise,
      set it to the number of Kafka servers.
    <span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>
  
  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>kafka.log.dir<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>/tmp/kafka-logs<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>
      Kafka log storage directory
    <span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>

  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>kafka.seed.brokers<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>FQDN1:9092,FQDN2:9092<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>
      List of Kafka brokers (comma separated, replace with correct values)
    <span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>


  <span class="c">&lt;!-- Metrics Configuration --&gt;</span>
  
  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>metrics.query.bind.address<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>0.0.0.0<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>
      Metrics query server host address
    <span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>


  <span class="c">&lt;!-- UI Configuration --&gt;</span>
  
  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>dashboard.bind.port<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>9999<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>
      CDAP UI bind port
    <span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>

<span class="nt">&lt;/configuration&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Check that the <code class="docutils literal"><span class="pre">router.server.address</span></code> property in <code class="docutils literal"><span class="pre">conf/cdap-site.xml</span></code> is set to the
<strong>hostname of the CDAP Router</strong>. The CDAP UI uses this property to connect to the Router:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>router.server.address<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>{router-host-name}<span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;description&gt;</span>Router address to which CDAP UI connects<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Depending on your installation, you may want to set these properties:</p>
<ul>
<li><p class="first">If you want to use <strong>an HDFS directory with a name</strong> other than <code class="docutils literal"><span class="pre">/cdap</span></code>:</p>
<ol class="arabic">
<li><p class="first">Create the HDFS directory you want to use, such as <code class="docutils literal"><span class="pre">/myhadoop/myspace</span></code>.</p>
</li>
<li><p class="first">Create an <code class="docutils literal"><span class="pre">hdfs.namespace</span></code> property for the HDFS directory in <code class="docutils literal"><span class="pre">conf/cdap-site.xml</span></code>:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>hdfs.namespace<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>/myhadoop/myspace<span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;description&gt;</span>Default HDFS namespace<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Ensure that the default HDFS user <code class="docutils literal"><span class="pre">yarn</span></code> owns that HDFS directory.</p>
</li>
</ol>
</li>
<li><p class="first">If you want to use <strong>a different HDFS user</strong> than <code class="docutils literal"><span class="pre">yarn</span></code>:</p>
<ol class="arabic">
<li><p class="first">Check that there is—and create if necessary—a corresponding user on all machines
in the cluster on which YARN is running (typically, all of the machines).</p>
</li>
<li><p class="first">Create an <code class="docutils literal"><span class="pre">hdfs.user</span></code> property for that user in <code class="docutils literal"><span class="pre">conf/cdap-site.xml</span></code>:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>hdfs.user<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>my_username<span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;description&gt;</span>User for accessing HDFS<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Check that the HDFS user owns the HDFS directory described by <code class="docutils literal"><span class="pre">hdfs.namespace</span></code> on all machines.</p>
</li>
</ol>
</li>
</ul>
<ul id="hadoop-configuration-explore-service">
<li><p class="first">To use the <strong>ad-hoc querying capabilities of CDAP,</strong> enable the CDAP Explore Service in
<code class="docutils literal"><span class="pre">conf/cdap-site.xml</span></code> (by default, it is disabled):</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>cdap.explore.enabled<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>true<span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;description&gt;</span>Enable Explore functionality<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</pre></div>
</div>
<p>This feature cannot be used unless the cluster has a compatible version of Hive installed.
See the section on <a class="reference external" href="installation.html#hadoop-hbase-environment">Hadoop/HBase Environment</a>.
To use this feature on secure Hadoop clusters, please see these instructions on
<a class="reference external" href="configuration.html#secure-hadoop">configuring secure Hadoop</a>.</p>
<p><strong>Note:</strong> Some versions of Hive contain a bug that may prevent the CDAP Explore Service from starting
up. See <a class="reference external" href="https://issues.cask.co/browse/CDAP-1865">CDAP-1865</a> for more information about the issue.
If the CDAP Explore Service fails to start and you see a <code class="docutils literal"><span class="pre">javax.jdo.JDODataStoreException:</span> <span class="pre">Communications</span> <span class="pre">link</span> <span class="pre">failure</span></code>
in the log, try adding this property to the Hive <code class="docutils literal"><span class="pre">hive-site.xml</span></code> file:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>datanucleus.connectionPoolingType<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>DBCP<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">If you&#8217;d like to publish metadata updates to an external Apache Kafka instance,
CDAP has the capability of publishing notifications upon metadata updates. Details on
the configuration settings and an example output are shown in the <a class="reference external" href="../../source/../../developers-manual/building-blocks/metadata-lineage.html#metadata-update-notifications" title="(in Cask Data Application Platform v3.2.1)"><span class="xref std std-ref">Metadata and
Lineage section</span></a> of the Developers&#8217; Manual.</p>
</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="secure-hadoop">
<span id="hadoop-configuration-for-secure-hadoop"></span><h2>Secure Hadoop<a class="headerlink" href="#secure-hadoop" title="Permalink to this headline">¶</a></h2>
<p>When running CDAP on top of a secure Hadoop cluster (using Kerberos
authentication), the CDAP processes will need to obtain Kerberos credentials in order to
authenticate with Hadoop, HBase, ZooKeeper, and (optionally) Hive.  In this case, the setting for
<code class="docutils literal"><span class="pre">hdfs.user</span></code> in <code class="docutils literal"><span class="pre">cdap-site.xml</span></code> will be ignored and the CDAP processes will be identified by the
default authenticated Kerberos principal.</p>
<p><strong>Note:</strong> CDAP support for secure Hadoop clusters is limited to the latest versions of CDH, HDP, and
Apache BigTop; currently, MapR is not supported on secure Hadoop clusters.</p>
<p>In order to configure <strong>CDAP for Kerberos authentication:</strong></p>
<ul>
<li><p class="first">Create a Kerberos principal for the user running CDAP.  The principal name should be in
the form <code class="docutils literal"><span class="pre">username/hostname&#64;REALM</span></code>, creating a separate principal for each host where a CDAP process
will run.  This prevents simultaneous login attempts from multiple hosts from being mistaken for
a replay attack by the Kerberos KDC.</p>
</li>
<li><p class="first">Generate a keytab file for each CDAP Master Kerberos principal, and place the file as
<code class="docutils literal"><span class="pre">/etc/security/keytabs/cdap.keytab</span></code> on the corresponding CDAP Master host.  The file should
be readable only by the user running the CDAP Master process.</p>
</li>
<li><p class="first">Edit <code class="docutils literal"><span class="pre">/etc/cdap/conf/cdap-site.xml</span></code> on each host running a CDAP process, substituting the Kerberos
primary (user) for <code class="docutils literal"><span class="pre">&lt;cdap-principal&gt;</span></code>, and your Kerberos authentication realm for <code class="docutils literal"><span class="pre">EXAMPLE.COM</span></code>,
when adding these two properties:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>cdap.master.kerberos.keytab<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>/etc/security/keytabs/cdap.service.keytab<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>

<span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>cdap.master.kerberos.principal<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;&lt;cdap-principal&gt;</span>/_HOST@EXAMPLE.COM<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">&lt;cdap-principal&gt;</span></code> is shown in the commands that follow as <code class="docutils literal"><span class="pre">cdap</span></code>; however, you
are free to use a different appropriate name.</p>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">/cdap</span></code> directory needs to be owned by the <code class="docutils literal"><span class="pre">&lt;cdap-principal&gt;</span></code>; you can set
that by running the following command as the <code class="docutils literal"><span class="pre">hdfs</span></code> user:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> hadoop fs -mkdir /cdap <span class="o">&amp;&amp;</span> hadoop fs -chown cdap /cdap
</pre></div>
</div>
</li>
<li><p class="first">When running on a secure HBase cluster, as the <code class="docutils literal"><span class="pre">hbase</span></code> user, issue the command:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> <span class="nb">echo</span> <span class="s2">&quot;grant &#39;cdap&#39;, &#39;ACRW&#39;&quot;</span> <span class="p">|</span> hbase shell
</pre></div>
</div>
</li>
<li><p class="first">When CDAP Master is started, it will login using the configured keytab file and principal.</p>
</li>
</ul>
<p>In order to configure <strong>CDAP Explore Service for secure Hadoop:</strong></p>
<ul>
<li><p class="first">To allow CDAP to act as a Hive client, it must be given <code class="docutils literal"><span class="pre">proxyuser</span></code> permissions and allowed from all hosts.
For example: set the following properties in the configuration file <code class="docutils literal"><span class="pre">core-site.xml</span></code>, where <code class="docutils literal"><span class="pre">cdap</span></code> is a system
group to which the <code class="docutils literal"><span class="pre">cdap</span></code> user is a member:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>hadoop.proxyuser.hive.groups<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>cdap,hadoop,hive<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>hadoop.proxyuser.hive.hosts<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>*<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">To execute Hive queries on a secure cluster, the cluster must be running the MapReduce <code class="docutils literal"><span class="pre">JobHistoryServer</span></code>
service. Consult your distribution documentation on the proper configuration of this service.</p>
</li>
<li><p class="first">To execute Hive queries on a secure cluster using the CDAP Explore Service, the Hive MetaStore service
must be configured for Kerberos authentication. Consult your distribution documentation on the proper
configuration of the Hive MetaStore service.</p>
</li>
</ul>
<p>With all these properties set, the CDAP Explore Service will run on secure Hadoop clusters.</p>
</div>
<div class="section" id="ulimit-configuration">
<span id="hadoop-configuration-ulimit"></span><h2>ULIMIT Configuration<a class="headerlink" href="#ulimit-configuration" title="Permalink to this headline">¶</a></h2>
<p>When you install the CDAP packages, the <code class="docutils literal"><span class="pre">ulimit</span></code> settings for the CDAP user are
specified in the <code class="docutils literal"><span class="pre">/etc/security/limits.d/cdap.conf</span></code> file. On Ubuntu, they won&#8217;t take
effect unless you make changes to the <code class="docutils literal"><span class="pre">/etc/pam.d/common-session</span> <span class="pre">file</span></code>. You can check
this setting with the command <code class="docutils literal"><span class="pre">ulimit</span> <span class="pre">-n</span></code> when logged in as the CDAP user.
For more information, refer to the <code class="docutils literal"><span class="pre">ulimit</span></code> discussion in the <a class="reference external" href="https://hbase.apache.org/book.html#ulimit">Apache HBase Reference
Guide</a>.</p>
</div>
<div class="section" id="writing-to-temp-files">
<span id="hadoop-configuration-tmp-files"></span><h2>Writing to Temp Files<a class="headerlink" href="#writing-to-temp-files" title="Permalink to this headline">¶</a></h2>
<p>Temp directories, depending on the distribution, are utilized by CDAP (the first two
are specified in <a class="reference internal" href="../../appendices/cdap-site.html#appendix-cdap-site-xml"><span>Appendix: cdap-default.xml and cdap-site.xml</span></a>):</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">app.temp.dir</span></code> (default: <code class="docutils literal"><span class="pre">/tmp</span></code>)</li>
<li><code class="docutils literal"><span class="pre">kafka.log.dir</span></code> (default: <code class="docutils literal"><span class="pre">/tmp/kafka-logs</span></code>)</li>
<li><code class="docutils literal"><span class="pre">/var/cdap/run</span></code></li>
<li><code class="docutils literal"><span class="pre">/var/log/cdap</span></code></li>
<li><code class="docutils literal"><span class="pre">/var/run/cdap</span></code></li>
<li><code class="docutils literal"><span class="pre">/var/tmp/cdap</span></code></li>
</ul>
<p>The CDAP user (the CDAP UNIX user) <strong>must</strong> be able to write to these directories, as they
are used for deploying applications and for operating CDAP.</p>
</div>
<div class="section" id="configuring-security">
<span id="hadoop-configuration-security"></span><h2>Configuring Security<a class="headerlink" href="#configuring-security" title="Permalink to this headline">¶</a></h2>
<p>For instructions on enabling CDAP Security, see <a class="reference internal" href="../../security.html#admin-security"><span>CDAP Security</span></a>;
and in particular, see the instructions for
<a class="reference internal" href="../../security.html#enabling-security"><span>configuring the properties of cdap-site.xml</span></a>.</p>
</div>
<div class="section" id="configuring-hortonworks-data-platform">
<span id="hadoop-configuration-hdp"></span><h2>Configuring Hortonworks Data Platform<a class="headerlink" href="#configuring-hortonworks-data-platform" title="Permalink to this headline">¶</a></h2>
<p>Beginning with <a class="reference external" href="http://hortonworks.com">Hortonworks Data Platform (HDP) 2.2</a>, the
MapReduce libraries are in HDFS. This requires an addition be made to the file
<code class="docutils literal"><span class="pre">cdap-env.sh</span></code> to indicate the version of HDP:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">export OPTS=&quot;${OPTS} -Dhdp.version=&lt;version&gt;&quot;</span>
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">&lt;version&gt;</span></code> matches the HDP version of the cluster. The build iteration must be
included, so if the cluster version of HDP is <code class="docutils literal"><span class="pre">2.2.6.0-2800</span></code>, use:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">export OPTS=&quot;${OPTS} -Dhdp.version=2.2.6.0-2800&quot;</span>
</pre></div>
</div>
<p>The file <code class="docutils literal"><span class="pre">cdap-env.sh</span></code> is located in the configuration directory, as described above
under <a class="reference external" href="configuration.html#configuration">Configuration</a>.</p>
<p>In addition, the property <code class="docutils literal"><span class="pre">app.program.jvm.opts</span></code> must be set in the <code class="docutils literal"><span class="pre">cdap-site.xml</span></code>:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>app.program.jvm.opts<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>-XX:MaxPermSize=128M ${twill.jvm.gc.opts} -Dhdp.version=<span class="nt">&lt;version&gt;</span> -Dspark.yarn.am.extraJavaOptions=-Dhdp.version=<span class="nt">&lt;version&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;description&gt;</span>Java options for all program containers<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</pre></div>
</div>
<p>Using the same example as above, substituting <code class="docutils literal"><span class="pre">2.2.6.0-2800</span></code> for <code class="docutils literal"><span class="pre">&lt;version&gt;</span></code>, as:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>app.program.jvm.opts<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>-XX:MaxPermSize=128M ${twill.jvm.gc.opts} -Dhdp.version=2.2.6.0-2800 -Dspark.yarn.am.extraJavaOptions=-Dhdp.version=2.2.6.0-2800<span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;description&gt;</span>Java options for all program containers<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="manuals links">
    <h3><a href="../../table-of-contents/../../index.html"
        rel="nofollow">CDAP Documentation v3.2.1</a></h3>
    <ul class="this-page-menu">
      <li><div class=""></div><a href="../../table-of-contents/../../index.html"
            rel="nofollow">Overview</a></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../introduction/index.html"
            rel="nofollow">Introduction to CDAP</a></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../developers-manual/index.html"
            rel="nofollow">Developers’ Manual</a></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../included-applications/index.html"
            rel="nofollow">Included Applications</a></li>
            
      <li><div class=""></div><b><a href="../../table-of-contents/../../admin-manual/index.html"
            rel="nofollow">Administration Manual</a></b></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../integrations/index.html"
            rel="nofollow">Integrations</a></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../examples-manual/index.html"
            rel="nofollow">Examples, Guides, and Tutorials</a></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../reference-manual/index.html"
            rel="nofollow">Reference Manual</a></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../faqs/index.html"
            rel="nofollow">FAQs</a></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../reference-manual/release-notes.html"
            rel="nofollow">Release Notes</a></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../reference-manual/glossary.html"
            rel="nofollow">Glossary</a></li>
            
      <li><div class=""></div><a href="../../table-of-contents/../../search.html"
            rel="nofollow">Search</a></li>
    </ul>
   </div><!--
  Copyright © 2014-2015 Cask Data, Inc.

  Licensed under the Apache License, Version 2.0 (the "License"); you may not
  use this file except in compliance with the License. You may obtain a copy of
  the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
  License for the specific language governing permissions and limitations under
  the License.
-->


    
<h3 class="pagenavtitle"><a href="../../table-of-contents.html">Administration Manual:<br> Table&nbsp;of&nbsp;Contents</a></h3>
<nav class="pagenav">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html"> Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html"> Installation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../ambari/index.html"> Apache Ambari (HDP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cloudera/index.html"> Cloudera Manager (CDH)</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html"> Hadoop</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#secure-hadoop">Secure Hadoop</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ulimit-configuration">ULIMIT Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#writing-to-temp-files">Writing to Temp Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-security">Configuring Security</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-hortonworks-data-platform">Configuring Hortonworks Data Platform</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="starting-verification.html">Starting and Verification</a></li>
<li class="toctree-l3"><a class="reference internal" href="upgrading.html">Upgrading CDAP</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../mapr/index.html"> MapR</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../security.html"> Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/index.html"> Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/index.html"> Appendices</a></li>
</ul>
 
</nav>
  <h4>Previous Topic</h4>
  <p class="topless"><a href="installation.html"
                        title="Previous Chapter">Hadoop: Installation</a></p>
  <h4>Next Topic</h4>
  <p class="topless"><a href="starting-verification.html"
                        title="Next Chapter">Hadoop: From Starting Services to Verification</a></p>
  <div role="note" aria-label="downloads links">
    <h3>Downloads</h3>
    <ul class="this-page-menu">
      <li><a href="http://docs.cask.co/cdap/3.2.1/cdap-docs-3.2.1-web.zip"
            rel="nofollow">Zip Archive of CDAP Documentation</a></li>
    </ul>
   </div>
  
<div id="searchbox" style="display: none" role="search">
  <h3>Quick Search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<div role="note" aria-label="other links">
    <h3><a href="http://docs.cask.co/" target="_blank">Documentation</a></h3>
    <ul class="this-page-menu">
        <li><a href="http://docs.cask.co/cdap/index.html" target="_blank">CDAP</a></li>
        <li><a href="http://docs.cask.co/coopr/index.html" target="_blank">Coopr</a></li>
        <li><a href="http://docs.cask.co/tephra/index.html" target="_blank">Tephra</em></a></li>
        <li><a href="http://docs.cask.co/tigon/index.html" target="_blank">Tigon</a></li>
    </ul>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;margin:0px auto;}
.tg td{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg th{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg .tg-s6z2{text-align:center;}
.tg .tg-0ord{text-align:right;}
.tg a{font-weight:bold;}
</style>
<table class="tg" width= 100%>
  <tr>
    <th class="tg-031e">Previous Topic: 
    <a title="Hadoop: Installation" href="installation.html" />Hadoop: Installation</a>&nbsp;&nbsp;
    
    </th>
    <th class="tg-s6z2">
        Copyright &copy; 2014-2015 Cask Data, Inc.
    
    </th>
    <th class="tg-0ord">&nbsp;&nbsp;Next Topic:
    <a title="Hadoop: From Starting Services to Verification" href="starting-verification.html" />Hadoop: From Starting Services to Verification</a>
    
    </th>
  </tr>
</table>

    </div>
  </body>
</html>