<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="robots" content="noindex, nofollow">

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Cask Data, Inc." name="author" />
<meta content="Copyright © 2015 Cask Data, Inc." name="copyright" />
<script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-55081520-2']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>Creating an ETL Adapter &mdash; Cask Data Application Platform 3.0.1 Documentation</title>
    
    <link rel="stylesheet" href="../_static/cdap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    



    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Cask Data Application Platform 3.0.1 Documentation" href="../index.html" />
    <link rel="next" title="Adapter Lifecycle Management" href="operations.html" />
    <link rel="prev" title="ETL Template and Plugin Details" href="templates.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="operations.html" title="Adapter Lifecycle Management"
             accesskey="N">Next</a> |</li>
        <li class="right" >
          <a href="templates.html" title="ETL Template and Plugin Details"
             accesskey="P">Previous</a> |</li>
        
        <script type="text/javascript" src="../_static/version-menu.js"></script>
        <script src="http://docs.cask.co/cdap/json-versions.js"/></script>
        <script>window.setVersion('3.0.1');</script>
       
        <li><a href="../table-of-contents.html">CDAP Application Templates</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="creating-an-etl-adapter">
<span id="apptemplates-etl-creating"></span><h1>Creating an ETL Adapter<a class="headerlink" href="#creating-an-etl-adapter" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Adapters can be created using the <a class="reference external" href="../source/../../reference-manual/http-restful-api/apptemplates.html#http-restful-api-apptemplates-adapters-creating" title="(in Cask Data Application Platform v3.0.2)"><span class="xref std std-ref">RESTful API</span></a>,
the <a class="reference external" href="../source/../../reference-manual/cli-api.html#cli" title="(in Cask Data Application Platform v3.0.2)"><span class="xref std std-ref">CDAP CLI</span></a>, or the <a class="reference external" href="../source/../../admin-manual/operations/cdap-ui.html#cdap-ui" title="(in Cask Data Application Platform v3.0.2)"><span class="xref std std-ref">CDAP UI</span></a>. In order to create an Adapter,
an Adapter configuration is required that specifies the source, transformations and sink
along with their properties.  (In the CDAP UI, the interface prompts you for the required
information.)</p>
</div>
<div class="section" id="configuration-file-format">
<span id="apptemplates-etl-configuration-file-format"></span><h2>Configuration File Format<a class="headerlink" href="#configuration-file-format" title="Permalink to this headline">¶</a></h2>
<div class="section" id="using-the-etl-batch-template">
<h3>Using the ETL Batch Template<a class="headerlink" href="#using-the-etl-batch-template" title="Permalink to this headline">¶</a></h3>
<p>With the ETL Batch Template, it requires a <code class="docutils literal"><span class="pre">schedule</span></code> property with a cron entry
specifying the frequency of the Batch job run, such as every day or every hour.</p>
<p>For example, this JSON (when in a file such as <code class="docutils literal"><span class="pre">config.json</span></code>) provides a
configuration for a Batch Adapter that runs every minute, reading data from a Stream
<em>myStream</em> and writing to a Dataset (Table) called <em>myTable</em>,  without any transformations:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">{</span>
<span class="go">  &quot;template&quot;:&quot;ETLBatch&quot;,</span>
<span class="go">  &quot;description&quot;:&quot;Batch ETL&quot;,</span>
<span class="go">  &quot;config&quot;:{</span>
<span class="go">      &quot;schedule&quot;:&quot;* * * * *&quot;,</span>
<span class="go">      &quot;source&quot;:{</span>
<span class="go">          &quot;name&quot;:&quot;Stream&quot;,</span>
<span class="go">          &quot;properties&quot;:{</span>
<span class="go">              &quot;name&quot;:&quot;myStream&quot;,</span>
<span class="go">              &quot;duration&quot;:&quot;1m&quot;</span>
<span class="go">          }</span>
<span class="go">      },</span>
<span class="go">      &quot;transforms&quot;:[],</span>
<span class="go">      &quot;sink&quot;:{</span>
<span class="go">          &quot;name&quot;:&quot;Table&quot;,</span>
<span class="go">          &quot;properties&quot;:{</span>
<span class="go">              &quot;name&quot;:&quot;myTable&quot;,</span>
<span class="go">              &quot;schema.row.field&quot;:&quot;ts&quot;</span>
<span class="go">          }</span>
<span class="go">      }</span>
<span class="go">   }</span>
<span class="go">}</span>
</pre></div>
</div>
<p>The Adapter launches a MapReduce program that runs every minute, reads data from the
Stream <em>myStream</em> and writes to a Table <em>myTable</em>. A Table Sink needs a row key field to
be specified and can use the timestamp of a Stream event for that.</p>
<p>To create an instance of this Adapter, called <em>streamAdapter</em>:</p>
<ul>
<li><p class="first">Using the <a class="reference external" href="../source/../../reference-manual/http-restful-api/apptemplates.html#http-restful-api-apptemplates-adapters-creating" title="(in Cask Data Application Platform v3.0.2)"><span class="xref std std-ref">RESTful API</span></a>:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">PUT /v3/namespaces/default/adapters/streamAdapter -d @config.json</span>
</pre></div>
</div>
</li>
<li><p class="first">Using <a class="reference external" href="../source/../../reference-manual/cli-api.html#cli" title="(in Cask Data Application Platform v3.0.2)"><span class="xref std std-ref">CDAP CLI</span></a>:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> create adapter streamAdapter &lt;path-to-config.json&gt;
</pre></div>
</div>
</li>
</ul>
<p>where <code class="docutils literal"><span class="pre">config.json</span></code> is the file that contains the Adapter configuration.</p>
</div>
<div class="section" id="using-the-etl-realtime-template">
<h3>Using the ETL Realtime Template<a class="headerlink" href="#using-the-etl-realtime-template" title="Permalink to this headline">¶</a></h3>
<p>This next configuration creates a Realtime Adapter that reads from Twitter and writes to a
Stream after performing a projection transformation:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">{</span>
<span class="go">  &quot;template&quot;:&quot;ETLRealtime&quot;,</span>
<span class="go">  &quot;description&quot;:&quot;Twitter to Stream: renames the &#39;message&#39; field name to &#39;tweet&#39;,</span>
<span class="go">  &quot;config&quot;:{</span>
<span class="go">      &quot;instances&quot;:&quot;1&quot;,</span>
<span class="go">      &quot;source&quot;:{</span>
<span class="go">          &quot;name&quot;:&quot;Twitter&quot;,</span>
<span class="go">          &quot;properties&quot;:{</span>
<span class="go">              &quot;AccessToken&quot;:&quot;xxx&quot;,</span>
<span class="go">              &quot;AccessTokenSecret&quot;:&quot;xxx&quot;,</span>
<span class="go">              &quot;ConsumerKey&quot;:&quot;xxx&quot;,</span>
<span class="go">              &quot;ConsumerSecret&quot;:&quot;xxx&quot;</span>
<span class="go">          }</span>
<span class="go">      },</span>
<span class="go">      &quot;transforms&quot;:[</span>
<span class="go">          {</span>
<span class="go">              &quot;name&quot;:&quot;Projection&quot;</span>
<span class="go">              &quot;properties&quot;:{</span>
<span class="go">                  &quot;drop&quot;:&quot;lang,time,favCount,source,geoLat,geoLong,isRetweet&quot;</span>
<span class="go">              }</span>
<span class="go">          }</span>
<span class="go">     ],</span>
<span class="go">     &quot;sink&quot;:{</span>
<span class="go">         &quot;name&quot;:&quot;Stream&quot;,</span>
<span class="go">         &quot;properties&quot;:{</span>
<span class="go">             &quot;name&quot;:&quot;twitterStream&quot;,</span>
<span class="go">             &quot;body.field&quot;:&quot;tweet&quot;</span>
<span class="go">         }</span>
<span class="go">      }</span>
<span class="go">   }</span>
<span class="go">}</span>
</pre></div>
</div>
<p>The ETL Realtime Template expects an instance property that will create <em>N</em> instances of the
adapter that run concurrently. In Standalone CDAP mode, this is implemented as multiple threads;
while in Distributed CDAP mode, it will create different YARN containers. The
number of instances of a Realtime Adapter cannot be changed during runtime.</p>
<p>The <code class="docutils literal"><span class="pre">instances</span></code> property value needs to be greater than 0. Note that the <code class="docutils literal"><span class="pre">instance</span></code>
property replaces the <code class="docutils literal"><span class="pre">schedule</span></code> property of the ETL Batch Template.</p>
<p>In this case, we will use a <em>ProjectionTransform</em> (a type of Transform) to drop certain
columns in the incoming data. A <em>StreamSink</em> in the final step needs a data field property
that it will use as the content for the data to be written.</p>
</div>
<div class="section" id="sample-adaptor-configurations">
<h3>Sample Adaptor Configurations<a class="headerlink" href="#sample-adaptor-configurations" title="Permalink to this headline">¶</a></h3>
<p><strong>Database:</strong> Sample config for using a Database Source and a Database Sink:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">{</span>
<span class="go">  &quot;config&quot;: {</span>
<span class="go">    &quot;schedule&quot;: &quot;* * * * *&quot;,</span>
<span class="go">    &quot;source&quot;: {</span>
<span class="go">      &quot;name&quot;: &quot;Database&quot;,</span>
<span class="go">      &quot;properties&quot;: {</span>
<span class="go">        &quot;importQuery&quot;: &quot;select id,name,age from my_table&quot;,</span>
<span class="go">        &quot;countQuery&quot;: &quot;select count(id) from my_table&quot;,</span>
<span class="go">        &quot;connectionString&quot;: &quot;jdbc:mysql://localhost:3306/test&quot;,</span>
<span class="go">        &quot;tableName&quot;: &quot;src_table&quot;,</span>
<span class="go">        &quot;user&quot;: &quot;my_user&quot;,</span>
<span class="go">        &quot;password&quot;: &quot;my_password&quot;,</span>
<span class="go">        &quot;jdbcPluginName&quot;: &quot;jdbc_plugin_name_defined_in_jdbc_plugin_json_config&quot;,</span>
<span class="go">        &quot;jdbcPluginType&quot;: &quot;jdbc_plugin_type_defined_in_jdbc_plugin_json_config&quot;</span>
<span class="go">        }</span>
<span class="go">      },</span>
<span class="go">    &quot;sink&quot;: {</span>
<span class="go">      &quot;name&quot;: &quot;Database&quot;,</span>
<span class="go">      &quot;properties&quot;: {</span>
<span class="go">        &quot;columns&quot;: &quot;id,name,age&quot;,</span>
<span class="go">        &quot;connectionString&quot;: &quot;jdbc:mysql://localhost:3306/test&quot;,</span>
<span class="go">        &quot;tableName&quot;: &quot;dest_table&quot;,</span>
<span class="go">        &quot;user&quot;: &quot;my_user&quot;,</span>
<span class="go">        &quot;password&quot;: &quot;my_password&quot;,</span>
<span class="go">        &quot;jdbcPluginName&quot;: &quot;jdbc_plugin_name_defined_in_jdbc_plugin_json_config&quot;,</span>
<span class="go">        &quot;jdbcPluginType&quot;: &quot;jdbc_plugin_type_defined_in_jdbc_plugin_json_config&quot;</span>
<span class="go">        }</span>
<span class="go">      },</span>
<span class="go">    &quot;transforms&quot;: [</span>
<span class="go">      ]</span>
<span class="go">    },</span>
<span class="go">  &quot;description&quot;: &quot;ETL using a Table as source and RDBMS table as sink&quot;,</span>
<span class="go">  &quot;template&quot;: &quot;ETLBatch&quot;</span>
<span class="go">}</span>
</pre></div>
</div>
<p><strong>JMS:</strong> A JMS server needs to be setup similar to using <a class="reference external" href="http://activemq.apache.org">ActiveMQ</a>:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">{</span>
<span class="go">  &quot;template&quot;: &quot;ETLRealtime&quot;,</span>
<span class="go">  &quot;config&quot;: {</span>
<span class="go">    &quot;instances&quot;: &quot;1&quot;,</span>
<span class="go">    &quot;source&quot;: {</span>
<span class="go">      &quot;name&quot;: &quot;JMS&quot;,</span>
<span class="go">      &quot;properties&quot;: {</span>
<span class="go">        &quot;jms.messages.receive&quot;: 50,</span>
<span class="go">        &quot;jms.destination.name&quot;: &quot;dynamicQueues/CDAP.QUEUE&quot;,</span>
<span class="go">        &quot;jms.factory.initial&quot;: &quot;org.apache.activemq.jndi.ActiveMQInitialContextFactory&quot;,</span>
<span class="go">        &quot;jms.provider.url&quot;: &quot;vm://localhost?broker.persistent=false&quot;</span>
<span class="go">      }</span>
<span class="go">    },</span>
<span class="go">    &quot;sink&quot;: {</span>
<span class="go">      &quot;name&quot;: &quot;Stream&quot;,</span>
<span class="go">      &quot;properties&quot;: {</span>
<span class="go">        &quot;name&quot;: &quot;jmsStream&quot;,</span>
<span class="go">        &quot;body.field&quot;: &quot;message&quot;</span>
<span class="go">      }</span>
<span class="go">    },</span>
<span class="go">    &quot;transforms&quot;: [</span>
<span class="go">    ]</span>
<span class="go">  }</span>
<span class="go">}</span>
</pre></div>
</div>
<p><strong>Kafka:</strong> A Kafka cluster needs to be setup, and certain minimum properties specified when
creating the source:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">{</span>
<span class="go">  &quot;template&quot;: &quot;ETLRealtime&quot;,</span>
<span class="go">  &quot;config&quot;: {</span>
<span class="go">    &quot;instances&quot;: &quot;1&quot;,</span>
<span class="go">    &quot;source&quot;: {</span>
<span class="go">      &quot;name&quot;: &quot;Kafka&quot;,</span>
<span class="go">      &quot;properties&quot;: {</span>
<span class="go">        &quot;kafka.partitions&quot;: 1,</span>
<span class="go">        &quot;kafka.topic&quot;: &quot;test&quot;,</span>
<span class="go">        &quot;kafka.brokers&quot;: &quot;localhost:9092&quot;</span>
<span class="go">      }</span>
<span class="go">    },</span>
<span class="go">    &quot;sink&quot;: {</span>
<span class="go">      &quot;name&quot;: &quot;Stream&quot;,</span>
<span class="go">      &quot;properties&quot;: {</span>
<span class="go">        &quot;name&quot;: &quot;myStream&quot;,</span>
<span class="go">        &quot;body.field&quot;: &quot;message&quot;</span>
<span class="go">      }</span>
<span class="go">    },</span>
<span class="go">    &quot;transforms&quot;: [</span>
<span class="go">    ]</span>
<span class="go">  }</span>
<span class="go">}</span>
</pre></div>
</div>
<p><strong>Prebuilt JARs:</strong> In a case where you&#8217;d like to use prebuilt third-party JARs (such as a
JDBC Driver) as a plugin, please refer to the section on <a class="reference internal" href="third-party.html#apptemplates-third-party"><span>Using Third-party Jars</span></a>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="manuals links">
    <h3><a href="../table-of-contents/../../index.html"
        rel="nofollow">CDAP Documentation v3.0.1</a></h3>
    <ul class="this-page-menu">
      <li><div class=""></div><a href="../table-of-contents/../../index.html"
            rel="nofollow">Overview</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../introduction/index.html"
            rel="nofollow">Introduction to CDAP</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../developers-manual/index.html"
            rel="nofollow">Developers’ Manual</a></li>
            
      <li><div class="new-icon"></div><b><a href="../table-of-contents/../../application-templates/index.html"
            rel="nofollow">Application Templates</a></b></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../admin-manual/index.html"
            rel="nofollow">Administration Manual</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../integrations/index.html"
            rel="nofollow">Integrations</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../examples-manual/index.html"
            rel="nofollow">Examples, Guides, and Tutorials</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../reference-manual/index.html"
            rel="nofollow">Reference Manual</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../reference-manual/release-notes.html"
            rel="nofollow">Release Notes</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../reference-manual/glossary.html"
            rel="nofollow">Glossary</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../reference-manual/faq.html"
            rel="nofollow">FAQ</a></li>
            
      <li><div class=""></div><a href="../table-of-contents/../../search.html"
            rel="nofollow">Search</a></li>
    </ul>
   </div><!--
  Copyright © 2014-2015 Cask Data, Inc.

  Licensed under the Apache License, Version 2.0 (the "License"); you may not
  use this file except in compliance with the License. You may obtain a copy of
  the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
  License for the specific language governing permissions and limitations under
  the License.
-->


    
<h3 class="pagenavtitle"><a href="../table-of-contents.html">Application Templates:<br> Table&nbsp;of&nbsp;Contents</a></h3>
<nav class="pagenav">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html"> Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html"> ETL Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates.html"> ETL Templates</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href=""> Creating an ETL Adapter</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration-file-format">Configuration File Format</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-the-etl-batch-template">Using the ETL Batch Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-the-etl-realtime-template">Using the ETL Realtime Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sample-adaptor-configurations">Sample Adaptor Configurations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="operations.html"> Adapter Lifecycle Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom.html"> Creating Custom ETL Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="third-party.html"> Using Third-party Jars</a></li>
</ul>

</nav>
  <h4>Previous Topic</h4>
  <p class="topless"><a href="templates.html"
                        title="Previous Chapter">ETL Template and Plugin Details</a></p>
  <h4>Next Topic</h4>
  <p class="topless"><a href="operations.html"
                        title="Next Chapter">Adapter Lifecycle Management</a></p>
  <div role="note" aria-label="downloads links">
    <h3>Downloads</h3>
    <ul class="this-page-menu">
      <li><a href="http://docs.cask.co/cdap/3.0.1/cdap-docs-3.0.1-web.zip"
            rel="nofollow">Zip Archive of CDAP Documentation</a></li>
    </ul>
   </div>
  
<div id="searchbox" style="display: none" role="search">
  <h3>Quick Search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<div role="note" aria-label="other links">
    <h3><a href="http://docs.cask.co/" target="_blank">Documentation</a></h3>
    <ul class="this-page-menu">
        <li><a href="http://docs.cask.co/cdap/index.html" target="_blank">CDAP</a></li>
        <li><a href="http://docs.cask.co/coopr/index.html" target="_blank">Coopr</a></li>
        <li><a href="http://docs.cask.co/tephra/index.html" target="_blank">Tephra</em></a></li>
        <li><a href="http://docs.cask.co/tigon/index.html" target="_blank">Tigon</a></li>
    </ul>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;margin:0px auto;}
.tg td{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg th{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg .tg-s6z2{text-align:center;}
.tg .tg-0ord{text-align:right;}
.tg a{font-weight:bold;}
</style>
<table class="tg" width= 100%>
  <tr>
    <th class="tg-031e">Previous Topic: 
    <a title="ETL Template and Plugin Details" href="templates.html" />ETL Template and Plugin Details</a>&nbsp;&nbsp;
    
    </th>
    <th class="tg-s6z2">
        Copyright &copy; 2014-2015 Cask Data, Inc.
    
    </th>
    <th class="tg-0ord">&nbsp;&nbsp;Next Topic:
    <a title="Adapter Lifecycle Management" href="operations.html" />Adapter Lifecycle Management</a>
    
    </th>
  </tr>
</table>

    </div>
  </body>
</html>