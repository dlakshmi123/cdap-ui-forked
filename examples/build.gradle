apply plugin: 'java'
apply from: "$rootProject.projectDir/gradle/run-maven.gradle"

task examplesClean << {
    runMaven("clean",  "-f $rootProject.projectDir/examples/pom.xml")
}

task examplesCompile << {
  runMaven("compile", getMavenOptions())
}

task examplesJar << {
    runMaven("package", getMavenOptions())
}

examplesCompile.dependsOn ':distributions:combinedApiJar'
examplesJar.dependsOn ':distributions:combinedApiJar'

build.dependsOn 'examplesJar'
clean.dependsOn 'examplesClean'

def getMavenOptions() {
    def apiJar = project(':distributions').combinedApiJar.outputs.files.singleFile
    return "-Dcontinuuity-api-jar-path=" + apiJar + " -P build" + " -f $rootProject.projectDir/examples/pom.xml"
}

